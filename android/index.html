<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Smooch Documentation</title>

    <link href="../images/favicon.ico" rel="icon" type="image/ico" />
    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="../javascripts/all.js" type="text/javascript"></script>

  </head>

  <body class="android android_index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/logo.png" />
      <div class="separator separator-top"></div>
      <div class="platform-nav">
        <div class="nav-label">Platform</div>
        <div class="platform-selector btn-group">
          <button class="btn btn-default" data-platform-name="ios">iOS</button>
          <button class="btn btn-default" data-platform-name="android">Android</button>
          <button class="btn btn-default" data-platform-name="web">Web</button>
        </div>
        <div class="clear"></div>
      </div>
      <div class="separator"></div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://smooch.io/'>Sign up for Smooch, it's free</a></li>
            <li><br/></li>
            <li><a href='/ios'>iOS Guide</a> | <a href='/api/ios'>Class Reference</a></li>
            <li><a href='/android'>Android Guide</a> | <a href='/api/android'>Class Reference</a></li>
            <li><a href='/javascript'>Web Guide</a> | <a href='https://github.com/smooch/smooch-js' target="_blank">Class Reference</a></li>
            <li><a href='/rest'>REST API Reference</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id='welcome'>Welcome</h1>
<p>Smooch lets you have rich conversations with your users, right in your app or on your website. If you want to learn more about Smooch, then visit our website at <a href="http://smooch.io">http://smooch.io</a> or <a href="https://app.smooch.io">sign up here</a>. This page provides in-depth documentation on Smooch&rsquo;s features and is meant to be a guide for developers integrating the SDK and app makers seeking to engage with their users.</p>

<p>Source code examples are provided for all of our SDKs, including both Objective-C and Swift for iOS. You can view code examples inline, and you can switch the programming language of the examples with the tabs in the top left.</p>

<p>If you have any other questions, feel free to reach out to us <a href="mailto:help@smooch.io">here</a>.</p>

          <h1 id='references'>References</h1>
<p>For more in-depth details on Smooch&rsquo;s APIs check out our API Reference documentation. The API reference documents every method and property available through Smooch.</p>

<ul>
<li><a href="http://docs.smooch.io/api/ios" target="_blank">iOS SDK Reference</a></li>
<li><a href="http://docs.smooch.io/api/android" target="_blank">Android SDK Reference</a></li>
<li><a href="https://github.com/smooch/smooch-js" target="_blank">Web SDK Reference</a></li>
<li><a href="/rest" target="_blank">REST API</a></li>
</ul>
<h2 id='upgrading-to-smooch'>Upgrading to Smooch</h2>
<p>Upgrading the SDKs to Smooch requires some changes to your existing code. These changes are documented in our upgrade guides:</p>

<ul>
<li><a href="https://github.com/smooch/smooch-ios/releases/tag/v3.0.0" target="_blank">iOS Upgrade Guide</a></li>
<li><a href="https://github.com/smooch/smooch-android/releases/tag/2.0.0" target="_blank">Android Upgrade Guide</a></li>
<li><a href="https://github.com/smooch/smooch-js/releases/tag/2.0.0" target="_blank">Web SDK Upgrade Guide</a></li>
</ul>

          <h1 id='adding-smooch-to-your-app'>Adding Smooch to your app</h1>
<p>There are a few ways you can include the Smooch plugin on your Android project.</p>

<p>The Smooch library comes in both the AAR and JAR packages. The AAR package is the preferred one but if you are not using Android Studio, you will need to install the JAR. The current supported <code class="prettyprint">compiledSdkVersion</code> must be at least <strong>21</strong>.</p>
<h2 id='android-studio-with-gradle'>Android Studio with Gradle</h2>
<p><span class="badge"><a href="https://bintray.com/smoochorg/maven/smooch/_latestVersion"><img alt="Bintray" src="https://api.bintray.com/packages/smoochorg/maven/smooch/images/download.svg" /></a></span></p>

<p>The Smooch library is hosted on <a href="https://bintray.com/smoochorg/maven/smooch">Bintray</a> and is available on <a href="http://jcenter.bintray.com/io/smooch/">JCenter</a>.</p>

<p>Setup JCenter as a repository.</p>
<pre class="highlight plaintext"><code>repositories {
    jcenter()
}
</code></pre>

<p>Add the dependencies right into your <code class="prettyprint">build.gradle</code> file.</p>
<pre class="highlight plaintext"><code>compile 'com.google.android.gms:play-services-gcm:7.5.0'
compile 'com.google.code.gson:gson:2.3.1'
compile 'com.squareup.okhttp:okhttp:2.4.0'
compile 'io.smooch:core:latest.release'
compile 'io.smooch:ui:latest.release'
</code></pre>

<p>Sync the Gradle project then add the necessary code to <a href="#initialize-smooch-in-your-app">initialize Smooch in your app</a>.</p>

<p><aside class="notice">
Smooch depends on a few external libraries that many applications already feature. For this reason, it does not bundle those dependencies inside the AAR or JAR packages.
</aside></p>
<h2 id='eclipse-netbeans-and-the-ant-build-system'>Eclipse, Netbeans and the ant build system</h2><h3 id='core-and-ui-modules'>Core and UI modules</h3>
<p>On Eclipse, we need to retrieve our <code class="prettyprint">eclipse</code> package to add Smooch and our dependencies to your project. Also, we will need to manually add permissions and services to the manifest.</p>

<ul>
<li>Download the <code class="prettyprint">smooch-eclipse-x.x.x.zip</code> file from <a href="https://bintray.com/smoochorg/maven/smooch">Bintray</a>. The package is located in <code class="prettyprint">Files/ui/x.x.x/smooch-eclipse-x.x.x.zip</code>.</li>
<li>Extract the zip and copy the <code class="prettyprint">appcompat</code> and <code class="prettyprint">smooch</code> folders to <strong>the root of your project</strong>.</li>
</ul>

<p><span class="half-width-img"><img alt="eclipse import" src="../images/eclipse_import.png" /></span></p>

<ul>
<li><p>In Eclipse, import both folders in your workspace as <code class="prettyprint">Existing Android Code</code>. After this step you should have two new projects added to your workspace named <code class="prettyprint">android-support-v7-appcompat</code> and <code class="prettyprint">ConversationActivity</code>.</p></li>
<li><p>Expand the <code class="prettyprint">android-support-v7-appcompat\libs</code> folder. Then on <strong>every</strong> library, right click on them and <code class="prettyprint">Build Path</code> &gt; <code class="prettyprint">Add to Build Path</code>.</p></li>
</ul>

<p><span class="half-width-img"><img alt="eclipse libraries" src="../images/eclipse_libraries.png" /></span></p>

<ul>
<li><p>Go to the properties of your project (i.e. <code class="prettyprint">right-click</code> &gt; <code class="prettyprint">Properties</code>). Then under the Android item, add a reference to the Smooch&rsquo;s <code class="prettyprint">ConversationActivity</code>.</p></li>
<li><p>Add these permissions in <strong>AndroidManifest.xml</strong>:</p></li>
</ul>
<pre class="highlight xml"><code><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.ACCESS_NETWORK_STATE"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.INTERNET"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"com.google.android.c2dm.permission.RECEIVE"</span><span class="nt">/&gt;</span>
</code></pre>

<ul>
<li>Add these services in <strong>AndroidManifest.xml</strong>:</li>
</ul>
<pre class="highlight xml"><code><span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"io.smooch.core.service.SmoochService"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"io.smooch.core.GcmInstanceIDListenerService"</span> <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.android.gms.iid.InstanceID"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/service&gt;</span>
<span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"io.smooch.core.GcmRegistrationIntentService"</span> <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"io.smooch.core.GcmService"</span> <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.android.c2dm.intent.RECEIVE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/service&gt;</span>
<span class="nt">&lt;receiver</span>
        <span class="na">android:name=</span><span class="s">"io.smooch.ui.notification.NotificationReceiver"</span>
        <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"io.smooch.NOTIFICATION"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/receiver&gt;</span>
</code></pre>

<ul>
<li>Add this activity in <strong>AndroidManifest.xml</strong>:</li>
</ul>
<pre class="highlight xml"><code><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">"io.smooch.ui.ConversationActivity"</span> <span class="na">android:theme=</span><span class="s">"@style/Theme.Smooch"</span> <span class="nt">/&gt;</span>
</code></pre>

<ul>
<li>Follow <a href="https://developers.google.com/android/guides/setup">these instructions to install the Google Play Services</a> to your project.</li>
</ul>

<p>Clean and build your project then add the necessary code to <a href="#initialize-smooch-in-your-app">initialize Smooch in your app</a>.</p>
<h3 id='core-module-only'>Core module only</h3>
<p>If you are planning on building your own UI and only <a href="http://docs.smooch.io/api/android/io/smooch/core/package-summary.html">use our API</a>, you can integrate the core module only.</p>

<ul>
<li>In your project directory, create a subdirectory called <strong>libs</strong> if it does not already exist</li>
<li>Copy <strong>Smooch-core.jar</strong> into the <strong>libs</strong> directory</li>
<li>Add these permissions in <strong>AndroidManifest.xml</strong>:</li>
</ul>
<pre class="highlight xml"><code><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.ACCESS_NETWORK_STATE"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.INTERNET"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"com.google.android.c2dm.permission.RECEIVE"</span><span class="nt">/&gt;</span>
</code></pre>

<ul>
<li>Add these services in <strong>AndroidManifest.xml</strong>:</li>
</ul>
<pre class="highlight xml"><code><span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"io.smooch.core.service.SmoochService"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"io.smooch.core.GcmInstanceIDListenerService"</span> <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.android.gms.iid.InstanceID"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/service&gt;</span>
<span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"io.smooch.core.GcmRegistrationIntentService"</span> <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"io.smooch.core.GcmService"</span> <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.android.c2dm.intent.RECEIVE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/service&gt;</span>
</code></pre>

<ul>
<li><p>Download and copy each dependency JAR into the <strong>libs</strong> subdirectory:</p>

<ul>
<li><a href="https://code.google.com/p/google-gson/">Google-Gson</a></li>
<li><a href="https://square.github.io/okhttp/">OkHttp and Okio</a></li>
</ul></li>
<li><p>Follow <a href="https://developers.google.com/android/guides/setup">these instructions to install the Google Play Services</a> to your project.</p></li>
</ul>
<h4 id='troubleshooting'>Troubleshooting</h4>
<p>If you get the following error when running your application</p>
<pre class="highlight plaintext"><code>[2015-07-23 09:33:42 - Dex Loader] Unable to execute dex: Multiple dex files define Lio/smooch/ui/BuildConfig;
[2015-07-23 09:33:42 - MainActivity] Conversion to Dalvik format failed: Unable to execute dex: Multiple dex files define Lio/smooch/ui/BuildConfig;
</code></pre>

<p>The fix is:</p>

<ul>
<li>Eclipse project properties &gt; <code class="prettyprint">Java build path</code> &gt; <code class="prettyprint">Order and export</code></li>
<li>Uncheck Android private libraries.</li>
</ul>

<p>See <a href="http://stackoverflow.com/a/26856255/213272">http://stackoverflow.com/a/26856255/213272</a>.</p>
<h2 id='initialize-smooch-in-your-app'>Initialize Smooch in your app</h2>
<p>After following the steps above, your app is setup for working with the Smooch SDK. Before your code can invoke its functionality, you&rsquo;ll have to initialize the library using your app&rsquo;s token.</p>

<p>This token is free and uniquely identifies your app and links it to the Smooch backend that does the heavy lifting necessary to bridge the gap between you and your users.</p>

<p>You can find your token by <a href="https://app.smooch.io">logging into Smooch</a> and copying it from the settings page as shown below.</p>

<p><img alt="App Token on Overview Page" src="../images/apptoken.png" /></p>

<p>Once you&rsquo;ve located your token, use the code below to initialize Smooch.</p>

<p>Add the following line of code to your <code class="prettyprint">onCreate</code> method on your <a href="http://developer.android.com/reference/android/app/Application.html">Application</a> class:</p>
<pre class="highlight java"><code><span class="n">Smooch</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"YOUR_APP_TOKEN"</span><span class="o">);</span>
</code></pre>

<p><aside class="notice">
    Make sure to replace <code class="prettyprint">YOUR_APP_TOKEN</code> with your app token.
</aside></p>

<p>If you don&rsquo;t have an <code class="prettyprint">Application</code> class, we recommend that you create one to make sure Smooch is always initialized properly. If you don&rsquo;t have one, you can copy the following and save it to your application package.</p>
<pre class="highlight java"><code><span class="kn">package</span> <span class="n">your</span><span class="o">.</span><span class="na">package</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.app.Application</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.smooch.core.Smooch</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">YourApplication</span> <span class="kd">extends</span> <span class="n">Application</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">onCreate</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">();</span>
        <span class="n">Smooch</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"YOUR_APP_TOKEN"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>

<p>You also need to <strong>declare</strong> your newly created <code class="prettyprint">Application</code> class in the <code class="prettyprint">&lt;application&gt;</code> tag in your <code class="prettyprint">AndroidManifest</code>.</p>
<pre class="highlight xml"><code><span class="nt">&lt;application</span>
    <span class="na">android:name=</span><span class="s">"your.package.YourApplication"</span><span class="nt">&gt;</span>
    ...
<span class="nt">&lt;/application&gt;</span>
</code></pre>

<p><aside class="notice">
    Remember to replace <code class="prettyprint">your.package</code>, <code class="prettyprint">YourApplication</code>, <code class="prettyprint">YOUR_APP_TOKEN</code> by the appropriate names and your app token.
</aside></p>
<h3 id='displaying-the-smooch-user-interface'>Displaying the Smooch User Interface</h3>
<p>Once you&rsquo;ve initialized Smooch, you&rsquo;re ready to try it out. </p>

<p>Find a suitable place in your app&rsquo;s interface to invoke Smooch and use the code below to display the Smooch user interface. You can bring up Smooch whenever you think that your user will need access to help or a communication channel to contact you.</p>
<pre class="highlight java"><code><span class="n">ConversationActivity</span><span class="o">.</span><span class="na">show</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</code></pre>

<p>You should also take the time to <a href="#configuring-push-notifications">configure the push notifications setup</a>.</p>

          <h2 id='configuring-push-notifications'>Configuring push notifications</h2>
<p>Push notifications are a great, unobtrusive way to let your users know that a reply to their message has arrived.</p>
<h3 id='step-1--generate-a-gcm-configuration-file-for-your-android-project'>Step 1. Generate a GCM configuration file for your Android project</h3>
<p><aside class="notice">
Following these steps will enable cloud messaging for your app and create a server API key
</aside></p>

<ol>
<li><p>Go to Google&rsquo;s <a href="https://developers.google.com/cloud-messaging/android/client#get-config">cloud messaging documentation</a></p></li>
<li><p>Click on <code class="prettyprint">GET A CONFIGURATION FILE</code> (you will be prompted to sign in to your Google account if you are not already signed in)</p></li>
<li><p>Follow the steps to generate your configuration file (for your package name, copy and paste the package used in your application&rsquo;s AndroidManifest.xml file)</p></li>
<li><p>Enable <strong>Google Cloud Messaging</strong> to your Android project</p></li>
<li><p>At the end of the page, continue to <em>Generate configuration files</em></p></li>
<li><p>Take note of the <em>Server API Key</em> and the <em>Sender ID</em>, we will need those in the second step</p></li>
<li><p>Download the <code class="prettyprint">google-services.json</code> file generated by the tool and save the file at the root of your Android application</p></li>
</ol>
<h3 id='step-2--configure-push-notifications-in-smooch'>Step 2. Configure push notifications in Smooch</h3>
<ol>
<li><p>Go to <a href="https://app.smooch.io">https://app.smooch.io</a> and log into your account.</p></li>
<li><p>Go to <strong>Settings</strong> &gt; <strong>Android</strong></p></li>
<li><p>Enter your <em>Server API Key</em> and <em>Sender ID</em> (which was retrieved earlier in Step 1)</p></li>
</ol>
<h3 id='step-3--configure-android-application-to-accept-push'>Step 3. Configure Android application to accept push</h3>
<p><aside class="notice">
Be sure to replace <code class="prettyprint">&lt;your_application_package&gt;</code> with your application package!
</aside></p>

<ol>
<li><p>Add the dependency to your project&rsquo;s top-level <code class="prettyprint">build.gradle</code>:</p>
<pre class="highlight plaintext"><code>classpath 'com.google.gms:google-services:1.3.0-beta1'
</code></pre></li>
<li><p>Add the plugin to your app-level <code class="prettyprint">build.gradle</code>:</p>
<pre class="highlight plaintext"><code>apply plugin: 'com.google.gms.google-services'
</code></pre></li>
<li><p>Add the following permissions and uses-permissions to your <code class="prettyprint">AndroidManifest.xml</code> file (typically before the opening <code class="prettyprint">&lt;application&gt;</code> tag):</p>
<pre class="highlight xml"><code><span class="nt">&lt;permission</span>
    <span class="na">android:name=</span><span class="s">"&lt;your_application_package&gt;.permission.C2D_MESSAGE"</span>
    <span class="na">android:protectionLevel=</span><span class="s">"signature"</span><span class="nt">/&gt;</span>

<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.WAKE_LOCK"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"&lt;your_application_package&gt;.permission.C2D_MESSAGE"</span><span class="nt">/&gt;</span>
</code></pre></li>
<li><p>Add the following receiver to your <code class="prettyprint">AndroidManifest.xml</code> file before the closing <code class="prettyprint">&lt;/application&gt;</code> tag:</p>
<pre class="highlight xml"><code><span class="nt">&lt;receiver</span>
        <span class="na">android:name=</span><span class="s">"com.google.android.gms.gcm.GcmReceiver"</span>
        <span class="na">android:exported=</span><span class="s">"true"</span>
        <span class="na">android:permission=</span><span class="s">"com.google.android.c2dm.permission.SEND"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.android.c2dm.intent.RECEIVE"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"&lt;your_application_package&gt;"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.android.c2dm.intent.REGISTRATION"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/receiver&gt;</span>
</code></pre></li>
</ol>
<h3 id='step-4--test-it-out'>Step 4. Test it out!</h3>
<p><aside class="warning">
You can&rsquo;t receive push notifications in the Android simulator, you must use a physical device.
</aside></p>

<ol>
<li><p>Kill and restart your app.</p></li>
<li><p>Launch Smooch.</p></li>
<li><p>Send a message.</p></li>
<li><p>Press the home button or navigate away from the conversation.</p></li>
<li><p>Reply to the message from your choice of Smooch integrated service</p></li>
</ol>

<p>You&rsquo;ll receive a notification on the phone!</p>

          <h2 id='configuring-agent-images'>Configuring agent images</h2>
<p>You can set an app maker&rsquo;s image in your app (as pictured below) by creating a <a href="http://www.gravatar.com/">Gravatar</a> image associated with the app maker&rsquo;s email address.
<img style="width:50%; min-width:200px; max-width:400px;" src="/images/agent_thumb.png" alt="Set agent images"/></p>

          <h1 id='users'>Users</h1>
          <h2 id='user-data'>User data</h2>
<p>Smooch allows you to specify profile information about your users so that you can better understand the context around a user&rsquo;s message.</p>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
    <span class="na">appToken</span><span class="p">:</span> <span class="s1">'your_app_token'</span><span class="p">,</span>
    <span class="na">givenName</span><span class="p">:</span> <span class="s1">'Doctor'</span><span class="p">,</span>
    <span class="na">surname</span><span class="p">:</span> <span class="s1">'Who?'</span><span class="p">,</span>
    <span class="na">email</span><span class="p">:</span> <span class="s1">'the-doctor@smooch.io'</span><span class="p">,</span>
    <span class="na">properties</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">'customProp'</span><span class="p">:</span> <span class="s1">'whatever you please'</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<h3 id='naming-the-current-user'>Naming the current user</h3>
<p>Once you set the user&rsquo;s name it will be persisted by Smooch so any future message from this user contain the value you provided. If the user&rsquo;s information changes, simply call the method a second time and the new information will overwrite it.</p>
<pre class="highlight objective_c"><code><span class="cp">#import &lt;Smooch/Smooch.h&gt;
</span>
<span class="p">[</span><span class="n">SKTUser</span> <span class="nf">currentUser</span><span class="p">].</span><span class="n">firstName</span> <span class="o">=</span> <span class="s">@"Doctor"</span><span class="p">;</span>
<span class="p">[</span><span class="n">SKTUser</span> <span class="nf">currentUser</span><span class="p">].</span><span class="n">lastName</span> <span class="o">=</span> <span class="s">@"Who"</span><span class="p">;</span>
</code></pre>
<pre class="highlight swift"><code><span class="err">#</span><span class="kd">import</span> <span class="o">&lt;</span><span class="kt">Smooch</span><span class="o">/</span><span class="kt">Smooch</span><span class="o">.</span><span class="n">h</span><span class="o">&gt;</span>

<span class="kt">SKTUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span><span class="o">.</span><span class="n">firstName</span> <span class="o">=</span> <span class="s">"Doctor"</span>
<span class="kt">SKTUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span><span class="o">.</span><span class="n">lastName</span> <span class="o">=</span> <span class="s">"Who"</span>
</code></pre>
<pre class="highlight java"><code><span class="kn">import</span> <span class="nn">io.smooch.core.User</span><span class="o">;</span>

<span class="n">User</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">().</span><span class="na">setFirstName</span><span class="o">(</span><span class="s">"Artour"</span><span class="o">);</span>
<span class="n">User</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">().</span><span class="na">setLastName</span><span class="o">(</span><span class="s">"Babaev"</span><span class="o">);</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">updateUser</span><span class="p">({</span>
    <span class="na">givenName</span><span class="p">:</span> <span class="s1">'Doctor'</span><span class="p">,</span>
    <span class="na">surname</span><span class="p">:</span> <span class="s1">'Who'</span>
<span class="p">})</span>
</code></pre>
<h3 id='getting-the-avatar-of-the-current-user'>Getting the avatar of the current user</h3>
<p>Setting the user&rsquo;s e-mail lets you see their gravatar in the e-mail conversation. The user will not see their own gravatar in the chat.</p>
<pre class="highlight objective_c"><code><span class="cp">#import &lt;Smooch/Smooch.h&gt;
</span>
<span class="p">[</span><span class="n">SKTUser</span> <span class="nf">currentUser</span><span class="p">].</span><span class="n">email</span> <span class="o">=</span> <span class="s">@"bob@example.com"</span><span class="p">;</span>
</code></pre>
<pre class="highlight swift"><code><span class="err">#</span><span class="kd">import</span> <span class="o">&lt;</span><span class="kt">Smooch</span><span class="o">/</span><span class="kt">Smooch</span><span class="o">.</span><span class="n">h</span><span class="o">&gt;</span>

<span class="kt">SKTUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="s">"bob@example.com"</span>
</code></pre>
<pre class="highlight java"><code><span class="kn">import</span> <span class="nn">io.smooch.core.User</span><span class="o">;</span>

<span class="n">User</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">().</span><span class="na">setEmail</span><span class="o">(</span><span class="s">"2ez@4rtz.com"</span><span class="o">);</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">updateUser</span><span class="p">({</span>
    <span class="na">email</span><span class="p">:</span> <span class="s1">'the-doctor@smooch.io'</span>
<span class="p">})</span>
</code></pre>
<h3 id='setting-the-signed-up-date'>Setting the signed up date</h3>
<p>Setting the user&rsquo;s signed up date allows Whispers based on that date to be sent to the right people. If not set, we&rsquo;ll default to the first time Smooch sees the user, which is the moment the <code class="prettyprint">init</code> call is made for the first time for a given user. It&rsquo;s best to set it yourself to avoid sending a welcome message to users that in fact signed up a long while ago.</p>
<pre class="highlight objective_c"><code><span class="cp">#import &lt;Smooch/Smooch.h&gt;
</span>
<span class="p">[</span><span class="n">SKTUser</span> <span class="nf">currentUser</span><span class="p">].</span><span class="n">signedUpAt</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSDate</span> <span class="nf">date</span><span class="p">];</span>
</code></pre>
<pre class="highlight swift"><code><span class="err">#</span><span class="kd">import</span> <span class="o">&lt;</span><span class="kt">Smooch</span><span class="o">/</span><span class="kt">Smooch</span><span class="o">.</span><span class="n">h</span><span class="o">&gt;</span>

<span class="kt">SKTUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span><span class="o">.</span><span class="n">signedUpAt</span> <span class="o">=</span> <span class="kt">NSDate</span><span class="p">()</span>
</code></pre>
<pre class="highlight java"><code><span class="kn">import</span> <span class="nn">io.smooch.core.User</span><span class="o">;</span>

<span class="n">User</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">().</span><span class="na">setSignedUpAt</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="mi">1420070400000</span><span class="n">l</span><span class="o">));</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">updateUser</span><span class="p">({</span>
    <span class="na">signedUpAt</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="s2">"Nov 6, 2013"</span><span class="p">)</span>
<span class="p">})</span>
</code></pre>
<h3 id='adding-custom-profile-information'>Adding custom profile information</h3>
<p>You can also specify any other kind of profile information that will be sent along when users contact you. You can also use any properties you store using this API to send targeted messages to your users proactively using our Whispers feature.</p>
<pre class="highlight objective_c"><code><span class="cp">#import &lt;Smooch/Smooch.h&gt;
</span>
<span class="p">[[</span><span class="n">SKTUser</span> <span class="nf">currentUser</span><span class="p">]</span> <span class="nf">addProperties</span><span class="p">:</span><span class="err">@</span><span class="p">{</span> <span class="s">@"nickname"</span> <span class="o">:</span> <span class="s">@"Lil Big Daddy Slim"</span><span class="p">,</span> <span class="s">@"weight"</span> <span class="o">:</span> <span class="mi">@650</span><span class="p">,</span> <span class="s">@"premiumUser"</span> <span class="o">:</span> <span class="nb">@YES</span> <span class="p">}];</span>
</code></pre>
<pre class="highlight swift"><code><span class="err">#</span><span class="kd">import</span> <span class="o">&lt;</span><span class="kt">Smooch</span><span class="o">/</span><span class="kt">Smooch</span><span class="o">.</span><span class="n">h</span><span class="o">&gt;</span>

<span class="kt">SKTUser</span><span class="o">.</span><span class="nf">currentUser</span><span class="p">()</span><span class="o">.</span><span class="nf">addProperties</span><span class="p">([</span> <span class="s">"nickname"</span> <span class="p">:</span> <span class="s">"Lil Big Daddy Slim"</span><span class="p">,</span> <span class="s">"weight"</span> <span class="p">:</span> <span class="mi">650</span><span class="p">,</span> <span class="s">"premiumUser"</span> <span class="p">:</span> <span class="kc">true</span> <span class="p">])</span>
</code></pre>
<pre class="highlight java"><code><span class="kn">import</span> <span class="nn">io.smooch.core.User</span><span class="o">;</span>

<span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">customProperties</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">customProperties</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"customDate"</span><span class="o">,</span> <span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
<span class="n">customProperties</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"customFlag"</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
<span class="n">customProperties</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"customDigit"</span><span class="o">,</span> <span class="mi">322</span><span class="o">);</span>
<span class="n">User</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">().</span><span class="na">addProperties</span><span class="o">(</span><span class="n">customProperties</span><span class="o">);</span>
</code></pre>

          <p>You can grab the current user with <code class="prettyprint">User.getCurrentUser</code> then set basic information with <code class="prettyprint">setFirstName</code>, <code class="prettyprint">setLastName</code>, <code class="prettyprint">setEmail</code> and <code class="prettyprint">setSignedUpAt</code>. You can also set your own custom properties by sending a map into <code class="prettyprint">addProperties</code>.</p>

          <p><aside class="notice">
Note: The maximum size for a property key is 100 bytes and the maximum property string value is 800 bytes. User keys and string values that exceed these limits will be truncated.
</aside></p>

          <h2 id='sensitive-user-data'>Sensitive user data</h2>
<p>Smooch sends messages using standard encryption protocols, but in order to keep your users completely safe, the best way is to inform your users they should never send sensitive data through Smooch messages, for example: credit card numbers, passwords, sensitive documents, and private photos.</p>

          <p>Smooch allows you to identify new users on the fly, engage with them in a single conversation thread across multiple devices, and associate user and device profile information so that you can better understand the context of a user&rsquo;s message.</p>
<h2 id='users-on-multiple-devices'>Users on multiple devices</h2>
<p>You may have users using your app on multiple devices. For example, suppose they have your app installed on both their iPhone and their iPad. You might also have Smooch integrated in both your mobile app as well as on your web site.</p>

<p>If you want the user to see the same conversation across devices you can do so by assigning your users a <code class="prettyprint">userId</code>. This will link a user across all devices and platforms that have integrated with your Smooch app. Specifying a <code class="prettyprint">userId</code> also facilitates <a href="#securing-your-users">user authentication</a>.</p>

<p>The <code class="prettyprint">userId</code> is a string that can be an email, GUID, or an existing ID from your own user directory. The <code class="prettyprint">userId</code> must be unique within a given Smooch app, and it will only link devices within a single Smooch app.</p>

<p><aside class="warning">
<strong>Caution:</strong> If you&rsquo;re specifying a <code class="prettyprint">userId</code> then in order to keep conversations private we strongly suggest <a href="#authenticating-users-optional">authenticating your users</a>. If a <code class="prettyprint">userId</code> is used without a JWT credential, then anyone who can discover a user&rsquo;s <code class="prettyprint">userId</code> could potentially eavesdrop on the conversation.
</aside></p>

<p>After Smooch has been initialized, you can set the <code class="prettyprint">userId</code> using the <code class="prettyprint">login</code> API:</p>
<pre class="highlight objective_c"><code><span class="p">[</span><span class="n">Smooch</span> <span class="nf">login</span><span class="p">:</span><span class="n">yourUserId</span> <span class="nf">jwt</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>
<pre class="highlight swift"><code><span class="kt">Smooch</span><span class="o">.</span><span class="nf">login</span><span class="p">(</span><span class="n">yourUserId</span><span class="p">,</span> <span class="nv">jwt</span><span class="p">:</span><span class="kc">nil</span><span class="p">)</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">yourUserId</span><span class="p">);</span>
</code></pre>
<pre class="highlight java"><code><span class="n">Smooch</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="n">yourUserId</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</code></pre>

<p>In most use cases Smooch is initialized synchronously as your app loads. For this reason, once you&rsquo;ve set your user&rsquo;s <code class="prettyprint">userId</code> for the first time it is recommended that you store that <code class="prettyprint">userId</code> locally on the device so that it does not need to be fetched again the next time the user opens the app. If your app knows the <code class="prettyprint">userId</code> at app boot time, instead of calling <code class="prettyprint">login</code> you can specify the <code class="prettyprint">userId</code> during Smooch initialization like so:</p>
<pre class="highlight objective_c"><code><span class="n">SKTSettings</span><span class="o">*</span> <span class="n">settings</span> <span class="o">=</span> <span class="p">[</span><span class="n">SKTSettings</span> <span class="nf">settingsWithAppToken</span><span class="p">:</span><span class="s">@"YOUR_APP_TOKEN"</span><span class="p">];</span>
<span class="n">settings</span><span class="p">.</span><span class="n">userId</span> <span class="o">=</span> <span class="n">yourUserId</span><span class="p">;</span>
<span class="p">[</span><span class="n">Smooch</span> <span class="nf">initWithSettings</span><span class="p">:</span><span class="n">settings</span><span class="p">];</span>
</code></pre>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">settings</span> <span class="o">=</span> <span class="kt">SKTSettings</span><span class="p">(</span><span class="nv">appToken</span><span class="p">:</span> <span class="s">"YOUR_APP_TOKEN"</span><span class="p">)</span>
<span class="n">settings</span><span class="o">.</span><span class="n">userId</span> <span class="o">=</span> <span class="n">yourUserId</span>
<span class="kt">Smooch</span><span class="o">.</span><span class="nf">initWithSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
    <span class="na">appToken</span><span class="p">:</span> <span class="s1">'YOUR_APP_TOKEN'</span><span class="p">,</span>
    <span class="na">userId</span><span class="p">:</span> <span class="nx">yourUserId</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java"><code><span class="n">Settings</span> <span class="n">settings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Settings</span><span class="o">(</span><span class="s">"YOUR_APP_TOKEN"</span><span class="o">);</span>
<span class="n">settings</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="n">yourUserId</span><span class="o">);</span>
<span class="n">Smooch</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">settings</span><span class="o">);</span>
</code></pre>
<h3 id='omitting-the-userid'>Omitting the userId</h3>
<p>Smooch will work perfectly fine without a <code class="prettyprint">userId</code>. Profile information can still be included but the user will only be able to access the conversation from the device they&rsquo;re currently using. This means that even if you specify the same profile information, if the same individual opens Smooch on a new device, or runs your web app in an incognito browser session, they will see a newly created empty conversation when they open Smooch. Only the <code class="prettyprint">userId</code> can be used to synchronize a conversation across devices.</p>

<p>A <code class="prettyprint">userId</code> can also be omitted at first and added at a later time. If you deploy an update to your app that assigns an existing user with a new <code class="prettyprint">userId</code> that they didn&rsquo;t have before, any existing conversation history they have will be preserved and their messages will start being synchronized across all devices where that <code class="prettyprint">userId</code> is being used. This is particularly useful if a user opens Smooch and starts a conversation before having logged in to your app.</p>
<h3 id='switching-users'>Switching users</h3>
<p>If your app allows a shared device to switch between multiple user identities you can call the <code class="prettyprint">login</code> API multiple times to switch between different <code class="prettyprint">userId</code>s.</p>
<h4 id='logging-out'>Logging out</h4>
<p>Your app may have a logout function which brings users back to a login screen. In this case you would want to revert Smooch to a pre-login state. You can do this by calling the <code class="prettyprint">logout</code> API.</p>

<p>Calling <code class="prettyprint">logout</code> will disconnect your user from any <code class="prettyprint">userId</code> they were previously logged in with and it will remove any conversation history stored on the device. Logging out will <em>not</em> disable Smooch. While logged out, the user is free to start a new conversation but they will show up as if <code class="prettyprint">userId</code> was <a href="#omitting-the-userid">omitted</a> during Smooch initialization.</p>
<pre class="highlight objective_c"><code><span class="p">[</span><span class="n">Smooch</span> <span class="nf">logout</span><span class="p">];</span>
</code></pre>
<pre class="highlight swift"><code><span class="kt">Smooch</span><span class="o">.</span><span class="nf">logout</span><span class="p">()</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">logout</span><span class="p">();</span>
</code></pre>
<pre class="highlight java"><code><span class="n">Smooch</span><span class="o">.</span><span class="na">logout</span><span class="o">();</span>
</code></pre>

          <h2 id='authenticating-users-optional'>Authenticating users (optional)</h2>
<p>Provided you&rsquo;re <a href="#users-on-multiple-devices">assigning <code class="prettyprint">userId</code>s to your users</a>, you can authenticate users to Smooch by issuing signed <a href="http://jwt.io">JSON web token</a> (JWT) credentials. This option requires your app to be connected to your own secure web service, or to a 3rd party equivalent such as <a href="https://parse.com">parse.com</a>. There are JWT libraries available supporting a wide variety of popular languages and platforms.</p>

<p>To issue JWTs:</p>

<ol>
<li><p>Generate a secret key for your Smooch app. You can do this from the <a href="https://app.smooch.io">Smooch dashboard</a> under the Settings tab.</p>

<p><img alt="Secret Keys" src="../images/secret_keys.png" /></p></li>
<li><p>Implement server side code to sign new JWTs using the key ID and secret provided. The JWT header must specify the key ID (<code class="prettyprint">kid</code>). The JWT payload must include a <code class="prettyprint">scope</code> claim of &lsquo;appUser&rsquo; and a <code class="prettyprint">userId</code> claim which you&rsquo;ve assigned to the app user.</p>

<p>A node.js sample is provided below:</p>
<pre class="highlight plaintext"><code>var jwt = require('jsonwebtoken');
var KEY_ID = '55e9f9bf7a0ce5ca2d429c17';
var SECRET = 'BFJJ88naxc5PZNAMU9KpBNTR';

var signJwt = function(userId) {
    return jwt.sign({
        scope: 'appUser',
        userId: userId
    },
    SECRET,
    {
        headers: {
            alg: 'HS256',
            typ: 'JWT',
            kid: KEY_ID
        }
    });
}
</code></pre></li>
<li><p>Issue a JWT for each user. You should tie-in the generation and delivery of this JWT with any existing user login process used by your app.</p></li>
<li><p>Specify the JWT when calling <code class="prettyprint">login</code> on the client:</p>
<pre class="highlight objective_c"><code><span class="p">[</span><span class="n">Smooch</span> <span class="nf">login</span><span class="p">:</span><span class="n">yourUserId</span> <span class="nf">jwt</span><span class="p">:</span><span class="n">yourJwt</span><span class="p">];</span>
</code></pre>
<pre class="highlight swift"><code><span class="kt">Smooch</span><span class="o">.</span><span class="nf">login</span><span class="p">(</span><span class="n">yourUserId</span><span class="p">,</span> <span class="nv">jwt</span><span class="p">:</span><span class="n">yourJwt</span><span class="p">)</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">yourUserId</span><span class="p">,</span> <span class="nx">yourJwt</span><span class="p">);</span>
</code></pre>
<pre class="highlight java"><code><span class="n">Smooch</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="n">yourUserId</span><span class="o">,</span> <span class="n">yourJwt</span><span class="o">);</span>
</code></pre></li>
</ol>

<p>Securing a <code class="prettyprint">userId</code> happens automatically by using a JWT for the first time. Once a JWT is used to authenticate an individual <code class="prettyprint">userId</code> with Smooch, that specific <code class="prettyprint">userId</code> will require a JWT credential in all future init or login calls made to Smooch.</p>

<p>Once you&rsquo;ve issued a <code class="prettyprint">userId</code> and <code class="prettyprint">JWT</code> to a user for the first time you can save them to the device locally. Having done this, instead of making a separate call to <code class="prettyprint">login</code> you can provide Smooch with the <code class="prettyprint">userId</code> and <code class="prettyprint">JWT</code> parameters during app initialization:</p>
<pre class="highlight objective_c"><code><span class="n">SKTSettings</span><span class="o">*</span> <span class="n">settings</span> <span class="o">=</span> <span class="p">[</span><span class="n">SKTSettings</span> <span class="nf">settingsWithAppToken</span><span class="p">:</span><span class="s">@"YOUR_APP_TOKEN"</span><span class="p">];</span>
<span class="n">settings</span><span class="p">.</span><span class="n">userId</span> <span class="o">=</span> <span class="n">yourUserId</span><span class="p">;</span>
<span class="n">settings</span><span class="p">.</span><span class="n">jwt</span> <span class="o">=</span> <span class="n">yourJwt</span><span class="p">;</span>
<span class="p">[</span><span class="n">Smooch</span> <span class="nf">initWithSettings</span><span class="p">:</span><span class="n">settings</span><span class="p">];</span>
</code></pre>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">settings</span> <span class="o">=</span> <span class="kt">SKTSettings</span><span class="p">(</span><span class="nv">appToken</span><span class="p">:</span> <span class="s">"YOUR_APP_TOKEN"</span><span class="p">)</span>
<span class="n">settings</span><span class="o">.</span><span class="n">userId</span> <span class="o">=</span> <span class="n">yourUserId</span>
<span class="n">settings</span><span class="o">.</span><span class="n">jwt</span> <span class="o">=</span> <span class="n">yourJwt</span>
<span class="kt">Smooch</span><span class="o">.</span><span class="nf">initWithSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
    <span class="na">appToken</span><span class="p">:</span> <span class="s1">'YOUR_APP_TOKEN'</span><span class="p">,</span>
    <span class="na">userId</span><span class="p">:</span> <span class="nx">yourUserId</span><span class="p">,</span>
    <span class="na">jwt</span><span class="p">:</span> <span class="nx">yourJwt</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java"><code><span class="n">Settings</span> <span class="n">settings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Settings</span><span class="o">(</span><span class="s">"YOUR_APP_TOKEN"</span><span class="o">);</span>
<span class="n">settings</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="n">yourUserId</span><span class="o">);</span>
<span class="n">settings</span><span class="o">.</span><span class="na">setJWT</span><span class="o">(</span><span class="n">yourJwt</span><span class="o">);</span>
<span class="n">Smooch</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">settings</span><span class="o">);</span>
</code></pre>

<p><aside class="warning">
If your secret key is ever compromised you can generate a new one. Smooch will accept a JWT as long as it contains all required fields and is signed with any of your Smooch app&rsquo;s valid secret keys. Deleting a secret key will invalidate all JWTs that were signed with it.
</aside></p>

          <h1 id='sending-action-buttons'>Sending action buttons</h1>
<p>You can send your users an action button with the following syntax:</p>
<pre class="highlight plaintext"><code>%[Button label here](http://anyurl.com)
</code></pre>

<p>This works from any channel you configured to use with Smooch. </p>

<p>When the user taps your button, we&rsquo;ll launch the appropriate intent based on the URL, so it can be whatever you want! Anything ranging from a web url, deep link or play store link works like a charm. </p>

<p><span class="half-width-img"><img alt="Action buttons" src="../images/action_button_android.png" /></span></p>

<p><aside class="notice">
Buttons will always be appended at the bottom of your message bubble.
</aside></p>
<h3 id='play-store-link'>Play store link</h3>
<p>For a play store link, you&rsquo;ll need your app&rsquo;s package. The URL of your app&rsquo;s page in the play store will have your package name at the end. The link to use in the Action input will then be <code class="prettyprint">market://details?id=&lt;package_name&gt;</code></p>

<p><img alt="Package Name" src="../images/package_name_from_url.png" /></p>

          <h1 id='integrations'>Integrations</h1>
          <h2 id='email'>Email</h2>
<p>By default, all new Smooch apps will have an email channel enabled using the email address of the account owner.</p>

<p>When users send you a message using Smooch, you will receive an email at the configured address(es). This e-mail contains the user&rsquo;s message, device information, and any profile information about the user that you captured in your app. You can respond to your user&rsquo;s message by responding directly to the email.</p>

<p><img src="/images/email_with_context.png" alt="Drawing" style="width: 80%;"/></p>
<h3 id='getting-help-from-your-team'>Getting help from your team</h3>
<p>If you want multiple team members to respond to your Smooch requests, you can specify multiple email addresses, or use a mailing list. Whenever a team member replies, the incoming email address and associated name will be used to determine the team member displayed to the user alongside the message.</p>

          <h2 id='slack'>Slack</h2>
<p>Slack is a communication tool that combines the best things about chat, email and the web to group all of your team&rsquo;s conversations and workflow into one beautiful, searchable place.</p>

<p>Smooch has a Slack integration that allows your team to effortlessly speak to your app&rsquo;s users, without leaving Slack.</p>
<h3 id='configuring-slack'>Configuring Slack</h3>
<p>Click the &ldquo;Connect to Slack&rdquo; button on the Slack integration page.</p>

<p><img style="width:50%; min-width:400px; max-width:800px;" src="/images/connecttoslack.png" alt="Connect to Slack"></p>

<p>This will send you to a Slack page where you will choose which slack team you want to add Smooch to, and it will show you the set of permissions Smooch is requesting in order to function. Once all is done, you&rsquo;ll be redirected back to Smooch. That&rsquo;s it, you&rsquo;re up and running.</p>

<p>When users send you messages, Smooch posts them to Slack. If it&rsquo;s a new conversation, a notification will appear in your dispatch channel in Slack. Smooch will choose <code class="prettyprint">#general</code> as your dispatch channel by default, and you can change this if you wish. The dispatch notification contains a link to a channel associated to the specific user that sent you the message.</p>

<p>By default, Smooch will generate random channel names for users who start conversations. If you want the channel names to be relevant, you must add a <a href="#user-data">first name, last name or email to the user</a>.</p>
<h3 id='talking-to-the-user'>Talking to the User</h3>
<p>From a channel associated with a user, you can get more information on the user and reply to their questions.</p>

<p>The messages you send in this new channel are not visible to your user. We do this so that you can invite teammates to collaborate on the user&rsquo;s issue without exposing your internal conversation.</p>

<p>When you&rsquo;re ready to send a message to the user, simply use Smooch&rsquo;s slash command:</p>
<pre class="highlight plaintext"><code>/sk TYPE YOUR MESSAGE HERE
</code></pre>

<p>You&rsquo;ll get a notification in the channel confirming that the message was received.</p>

<p>If you want to consult any <a href="#user-data">user data</a> that you&rsquo;ve associated with the user in order to aid the help process, simply use the command below:</p>
<pre class="highlight plaintext"><code>/sk !profile
</code></pre>

          <h2 id='help-scout'>Help Scout</h2>
<p><a href="http://www.helpscout.net/">Help Scout</a> is a scalable, elegant and intuitive help desk solution. By connecting Smooch to Help Scout, you can manage in-app conversations you have with your users directly from Help Scout. This way, you can use the same system to handle your team&rsquo;s e-mail and in-app support channels. Unlike other Help Scout conversations, agent replies in conversations initiated by Smooch app users won&rsquo;t be sent by email, instead they will appear directly in the app.</p>
<h3 id='configuring-help-scout-to-work-with-smooch'>Configuring Help Scout to work with Smooch</h3>
<p>Configuring Help Scout is super easy. All you have to do is copy/paste a Help Scout API key into our integration page.</p>

<ol>
<li><p>Log in to your Help Scout account, go to &ldquo;Your Profile&rdquo; -&gt; &ldquo;API Keys&rdquo; and generate an API key.</p></li>
<li><p>On the Help Scout page in your <a href="https://app.smooch.io">Smooch admin area</a>, paste the API key into the field that says &ldquo;Paste API Key here.&rdquo;</p></li>
<li><p>Now, pick the mailbox you want to receive app user messages in, and next time one of your users messages you using Smooch, the conversation will appear in the Help Scout mailbox.</p></li>
</ol>

<p><img style="width:50%; min-width:400px; max-width:800px;" src="/images/helpscout_settings.png" alt="Configure Help Scout integration page"></p>
<h3 id='instant-messaging-from-a-help-scout-mailbox'>Instant messaging from a Help Scout mailbox</h3>
<p>You can change or delete the Help Scout mailbox that Smooch sends messages to, but you should note that conversations will not automatically migrate to the new mailbox. You must move the conversations you wish to have in the new mailbox via the Help Scout UI. Otherwise they will continue in the previously configured mailbox. Update your settings before deleting a Help Scout mailbox. If the mailbox configured on Smooch no longer exists, messages will be lost.</p>

          <h2 id='hipchat'>HipChat</h2>
<p>HipChat is a team-based chat tool that helps to group all of your team&rsquo;s conversations and workflow into one beautiful, searchable place.</p>

<p>Smooch has a HipChat integration that allows your team to communicate with your app&rsquo;s users, without leaving HipChat.</p>
<h3 id='configuring-hipchat'>Configuring HipChat</h3><h4 id='step-1--authorize-smooch-so-that-it-can-talk-to-your-hipchat'>Step 1. Authorize Smooch so that it can talk to your HipChat</h4>
<p><br/>
<img style="width:50%; min-width:400px; max-width:800px;" src="/images/hipchat_smooch_integration.png" alt="HipChat integration"></p>
<h4 id='step-2---'>Step 2. &hellip;</h4>
<p><img alt="There is no Step 2" src="../images/step_2.png" />
<br/></p>

<p>HipChat Connect has allowed Smooch to integrate into HipChat in some awesome ways. 
<br/>
You can easily view your active conversations and user profiles at a glance.</p>

<p><img alt="At a glance" src="../images/hipchat_glance.png" />
<br/></p>

<p>We&rsquo;ve also added some handy options to the context menu so that you can easily use Smooch&rsquo;s features directly within HipChat.</p>

<p><img alt="HipChat actions" src="../images/hipchat_actions.png" /></p>

<p>This makes adding internal notes for fellow colleagues really easy.</p>

<p><img style="width:50%; min-width:400px; max-width:800px;" src="/images/hipchat_note.png" alt="Note"></p>

<p>And you can send your users action buttons through an interface we baked specially for HipChat.</p>

<p><br/>
<img style="width:50%; min-width:400px; max-width:800px;" src="/images/hipchat_add_action.png" alt="HipChat add action"></p>

          <h2 id='zendesk'>Zendesk</h2>
<p>Zendesk is a CRM platform specialized in managing support tickets. Our Zendesk integration combines all the advantages of in-app messaging with a powerful CRM back-end.</p>
<h3 id='configuring-zendesk-ticketing'>Configuring Zendesk ticketing</h3>
<p>Configuring Smooch to communicate with Zendesk is easy. Go to your app settings on the Smooch admin page, and in the Zendesk settings, enter your Zendesk subdomain and click on the authenticate button.</p>

<p><img style="width:50%; min-width:400px; max-width:800px;" src="/images/zendesk_integration.png" alt="Configure Zendesk integration page"/></p>

<p>In order to maintain all your interactions with an app user under a single Zendesk End-user profile, it&rsquo;s important to <a href="#user-data">set the email</a> of your user in your app&rsquo;s Smooch integration.</p>
<h4 id='working-with-zendesk-email-signatures'>Working with Zendesk email signatures</h4>
<p>Smooch automagically removes agent&rsquo;s personal signatures from messages. Global signatures can be set, but must be prefixed with <code class="prettyprint">--</code>, if they arent, youll see them appear in SK message bubbles, and it can be unsightly.
<img style="width:50%; min-width:200px; max-width:400px;" src="/images/unsightly_signature.png" alt="Oops, how unsightly"/></p>
<h4 id='optional-additional-information-on-configuration'>Optional additional information on Configuration</h4>
<p>Once you are authenticated with your Zendesk app, Smooch will automatically configure targets and triggers so that your Zendesk agents can communicate with your Smooch app users.</p>

<p>During the configuration process any existing triggers in your Zendesk settings will be modified to not email the End-user if the ticket is tagged &ldquo;smooch&rdquo;. We do this to avoid duplicating the conversation, and to remove any reason for the app user to leave your app to respond via email.</p>

<p>It&rsquo;s suggested that you don&rsquo;t modify the targets and triggers that Smooch configures for you on Zendesk. However, if you do, and anything ever goes wrong, it&rsquo;s easy to fix. Just return to your app settings on the Smooch admin page and in the Zendesk settings click &ldquo;Remove Integration.&rdquo; Re-adding the integration will remove previously configured Smooch targets and triggers and refresh your configuration.</p>

<p>Note: Smooch only ever configures one target and trigger per a Zendesk subdomain. In the event that multiple apps, or even mutliple Smooch accounts are authorized for a Zendesk subdomain, the triggers and targets will not be removed until all Smooch apps have had the Zendesk integration removed.</p>
<h3 id='rate-limiting'>Rate Limiting</h3>
<p>Zendesk limits each account to 200 requests per a minute (globally). Additionally, they only allow 15 comments to be made on each individual ticket (regardless of whether the comment is an agent or app user) within a 10 minute period.</p>

<p>In the unlikely event that a conversation surpasses the rate limit, the agent will recieve a message in the Zendesk UI saying as much, and preventing the ticket from being updated for a certain period of time, usually around 6 minutes. Your app user&rsquo;s messages will be queued up and sent after the time period specified by Zendesk.</p>

<p>To reduce the likelihood of you bumping up against the rate limit, Smooch batches together all messages sent from the app user within a 5 second period into a single comment.</p>

          <h2 id='twilio'>Twilio</h2>
<p><a href="https://www.twilio.com/">Twilio</a> is an SMS messaging service. Our Twilio integration allows your users to send you text messages at your Twilio number for your to receive in any of our channels like Slack, HipChat or Help Scout. Your replies are sent back as an SMS to the user.</p>
<h3 id='configuring-twilio'>Configuring Twilio</h3>
<p>You&rsquo;ll need a Twilio account with a phone number configured on it. A trial account is ok to test but is only good to send SMS to the phone you used while signing up. Once you&rsquo;ve set up your Twilio account, obtain your API credentials from the Twilio account settings page and enter them into the corresponding Smooch page.</p>

<p><img alt="Enter API credentials" src="../images/twilio.png" /></p>

<p>Once your Twilio account is authenticated, select the phone number you want to use and hit save. You should now be able to receive messages from your Twilio phone number and reply via any of your configured channels.</p>

          <h2 id='stripe'>Stripe</h2>
<p>Stripe is a developer-friendly platform that instantly enables businesses to accept and manage payments online and in mobile apps. Our Stripe integration allows you to request payment from your users directly within the conversation.
Credit card informations are never seen by our servers, everything related to transactions is all handled by Stripe.</p>

          <div class="third-width-img">
    <img alt="in conversation money request" src="../images/stripe_android_request.png" />
    <img alt="card capture ui" src="../images/stripe_android_card_input.png" />
    <img alt="payment completed ui" src="../images/stripe_android_completed.png" />
</div>

          <h3 id='saved-credit-cards'>Saved Credit Cards</h3>
<p>We will automatically save credit cards for users who are JWT protected.</p>

<p>On subsequent purchases, they will be presented a dialog allowing them to buy without having to re-enter their card.</p>

          <div class="third-width-img" style="text-align:center">
    <img alt="in conversation saved card money request" src="../images/stripe_saved_android_request.png" />
    <img alt="saved card ui" src="../images/stripe_saved_android_card.png" />
</div>

          <h3 id='transaction-fees'>Transaction fees</h3>
<p>Smooch takes a 0.5% + 20 fee on every payment we facilitate. This is separate from the <a href="https://stripe.com/ca/pricing">Stripe fees</a> which are currently at 2.9% + 30. For example, on a $100 USD payment, Smooch will receive $0.70 USD and Stripe $3.20 USD.</p>
<h3 id='configuring-stripe'>Configuring Stripe</h3>
<p>From the Stripe integration page, select which Stripe mode you want Smooch to be using. </p>

<p><img alt="Stripe integration page ui" src="../images/Stripe_integration_page_ui.png" /></p>

<p>Use Test mode during development. While in this mode you can use Stripe&rsquo;s <a href="https://stripe.com/docs/testing#cards">test credit card numbers</a> to make transactions without using real money. Use Live mode to get real money .</p>

<p>Then Click &ldquo;Authenticate your Stripe account&rdquo;. This will send you to a Stripe page where you can select which Stripe account to link Smooch with. </p>

<p><aside class="info">
If you are using test mode, notice the &ldquo;Skip this account form&rdquo; at the top of the Stripe page. There is no need for a bank account in test mode.
</aside></p>
<h3 id='requesting-payments'>Requesting payments</h3>
<p>While inside a conversation with a user you can send a buy button with the following syntax</p>
<pre class="highlight plaintext"><code>$[Button label here](25.00)
</code></pre>

<p>This works from any channel you configured to use with Smooch.</p>

<p>The amount you specify can be just a dollars amount or dollars and cents as in the example. Note that all amounts are in USD.</p>

<p>Once the user completes a payment you&rsquo;ll get a confirmation along with a link to the payment page on Stripe.</p>

          <p><aside class="notice">
If your users are messaging you by SMS via our <a href="#twilio">Twilio</a> integration, they&rsquo;ll be getting a web link instead of a buy button. It will take them to a payment web page where we use <a href="https://stripe.com/docs/checkout">Checkout.js</a> from Stripe to secure the payment. This mechanism is also used for Smooch Android SDK versions older than 2.1.
</aside></p>

          <h2 id='shopify'>Shopify</h2>
<p><a href="https://www.shopify.com/">Shopify</a> is a simple way to set up an online store to organize products, accept credit card payments, and manage orders.</p>

<p>This integration adds the Smooch web plugin to your Shopify online store. Smooch will set your <code class="prettyprint">appToken</code> and add the code snippet in your theme.</p>
<h3 id='adding-smooch-to-your-store'>Adding Smooch to your store</h3>
<p>In order to append the plugin to your theme, all you need to do is to press on <em>Authenticate</em> from the integration page or install Smooch from the <a href="https://apps.shopify.com/smooch">Shopify marketplace</a>.</p>

<p><img alt="From the integration page" src="../images/shopify.png" /></p>

<p><aside class="notice">Integrating Smooch will modify your current Shopify theme. If your theme ever changes, you will need to re-enable this integration.</aside></p>
<h3 id='adding-more-customer-informations'>Adding more customer informations</h3>
<p>If available, Smooch already includes the <code class="prettyprint">givenName</code>, <code class="prettyprint">surname</code>, <code class="prettyprint">email</code>, <em>order count</em>, <em>last order placed</em>, <em>lifetime spent</em> and the Admin url of the current <code class="prettyprint">customer</code>. It is also possible to retrieve more information for Shopify&rsquo;s <a href="https://docs.shopify.com/themes/liquid-documentation/objects/customer"><code class="prettyprint">customer</code> object</a> (it could also be <code class="prettyprint">orders</code>, <code class="prettyprint">address</code> or any object available in <a href="https://docs.shopify.com/themes/liquid-documentation/objects">your theme</a>). To do so, you need to <code class="prettyprint">Edit HTML/CSS</code> of your current theme to update the <code class="prettyprint">snippets/smooch.liquid</code> file and add them into <code class="prettyprint">properties</code> of the <code class="prettyprint">Smooch.updateUser</code> call.</p>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">updateUser</span><span class="p">({</span>
  <span class="na">givenName</span><span class="p">:</span> <span class="s2">"{{ customer.first_name }}"</span><span class="p">,</span>
  <span class="na">surname</span><span class="p">:</span> <span class="s2">"{{ customer.last_name }}"</span><span class="p">,</span>
  <span class="na">email</span><span class="p">:</span> <span class="s2">"{{ customer.email }}"</span><span class="p">,</span>
  <span class="na">properties</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"Customer Account"</span><span class="p">:</span> <span class="s2">"{{ shop.secure_url }}/admin/customers/{{ customer.id }}"</span><span class="p">,</span>
    <span class="p">...</span>
    <span class="s2">"Location"</span><span class="p">:</span> <span class="s2">"{{ customer.default_address.city }}, {{ customer.default_address.country_code }}"</span><span class="p">,</span>
    <span class="s2">"Cart Items"</span><span class="p">:</span> <span class="s2">"{{ cart.item_count }} {{ cart.item_count | pluralize: 'item', 'items' }} ({{ cart.total_price | money }})"</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

          <h2 id='connecting-to-your-crm'>Connecting to your CRM</h2>
<p>Smooch&rsquo;s been designed to fit into your existing workflow so you can focus on speaking to your users and take advantage of whatever medium makes you most effective.</p>

<p>In addition to deep integration with <a href="#zendesk">Zendesk</a>, since Smooch uses e-mail to manage its communication, it&rsquo;s easy to use your favourite CRM to manage incoming conversations as tickets if you want to benefit from the additional tools this allows.</p>

<ol>
<li><p>Take note of the e-mail address that the CRM uses to receive new support requests.</p></li>
<li><p>Set Smooch&rsquo;s forwarding address to the address you noted in step 1. </p></li>
<li><p>Turn off any kind of signatures or annotations in your CRM to ensure that users receive a concise chat bubble when you reply.</p></li>
</ol>

          <h1 id='whispers'>Whispers</h1>
<p>Smooch allows you to reach out to your users at scale so that you can start conversations with them about anything that matters to your app, even if they aren&rsquo;t in need of service or support. We call this feature &ldquo;Whispers&rdquo; and it allows you to automatically send a message to a targeted group of users at exactly the right time.</p>

<p>To help get you started, we&rsquo;ve built in 5 basic templates and also allow you to create your own using any custom metadata that you&rsquo;re capturing with the <code class="prettyprint">Smooch User</code> API.</p>

<ul>
<li><p><em>Welcome Whisper</em> : Welcome new users to your app by starting a conversation where you can answer pressing questions and get initial feedback.</p></li>
<li><p><em>Re-Engage Users</em> : Send a message to users who were last seen using the app at least 7 days ago.</p></li>
<li><p><em>Announcement</em> : Send a message to all users when they launch the app.</p></li>
<li><p><em>Ask for app rating</em> : Send a message to all users who have signed up at least 5 days ago, prompting them to rate your app in the app store.</p></li>
<li><p><em>Auto-response</em> : Inform users of when to expect an answer, when they send their first message.</p></li>
</ul>

<p>You can start from any of these templates and customize it to meet your needs. You can also create a custom Whisper from scratch and go beyond these templates. You can use Whispers to ask for reviews from your most engaged users at the right time, you can notify users of older versions of your app about new versions, and more.</p>
<h2 id='how-whispers-work'>How Whispers work</h2>
<p>You create Whispers from within the <a href="https://app.smooch.io">Smooch dashboard</a> by specifying which users should receive your message, the message you&rsquo;d like to send to your users and the event that should trigger delivery of this message. For example, to create a Whisper that would check in to see how users are doing 2 days after installing an app, you&rsquo;d create a custom Whisper with these settings:</p>

<p><img alt="Whisper creation form" src="../images/create_whisper.png" /></p>
<h3 id='targeting-a-group-of-users'>Targeting a group of users</h3>
<p>You can target your users based on any information that you&rsquo;ve stored using the <code class="prettyprint">Smooch User</code> API. We also provide several built-in properties that you can use without instrumenting your app with calls to <code class="prettyprint">Smooch User</code> class.</p>

<ul>
<li><p><em>All users</em> : Send the Whisper to <em>everyone</em> that has your app. Whispers that target everyone must be <a href="#when-are-whispers-sent">linked to an event</a>.</p></li>
<li><p><em>Signed Up</em> : Send the message before/after a specified number of days. For example, you can use this to send a message to all users who&rsquo;ve been using your app for less than a day or more than a week. See <a href="#setting-the-signed-up-date">here</a> for more information.</p></li>
<li><p><em>Last Seen</em> : Send the message based on when the user last interacted with your app. This value is updated automatically each time a user launches your app.</p></li>
<li><p><em>App Version</em> : Send the message to users who are using (or not using) a specific version of your app. The value for this property is taken from the CFBundleShortVersionString key in your app&rsquo;s info.plist file, and is updated each time the user launches your app.</p></li>
</ul>

<p>In order to create Whispers based on properties you&rsquo;ve defined using the <code class="prettyprint">Smooch User</code> class, you&rsquo;ll need to run your app and ensure that at least 1 of your users was tagged with the property you want to base your Whisper on. Alternatively, you can make a HTTP request to the <code class="prettyprint">PUT /appusers</code> route of the <a href="/rest">Smooch REST API</a>. For more information on using custom properties, read our <a href="#user-data">documentation on the subject</a>.</p>
<h3 id='personalizing-the-message-text'>Personalizing the message text</h3>
<p>You can personalize the message that&rsquo;s being sent with the first or last name of the user. To do this, simply use the syntax <code class="prettyprint">{{ firstName || fallback }}</code> when creating your message. If the user&rsquo;s firstName hasn&rsquo;t been set by your code through the <code class="prettyprint">Smooch User</code> class then the placeholder will be replaced with the string specified as <code class="prettyprint">fallback</code>.</p>

          <h2 id='when-are-whispers-sent'>When are Whispers sent</h2>
<p>Whispers can be sent either when a specified event occurs in your app or when a user&rsquo;s profile information matches the criteria of the target group.</p>

<p>Whispers that are based on custom events defined by you in your app are tied to the execution of the Smooch <code class="prettyprint">track:</code> method. When <code class="prettyprint">track:</code> is called, Smooch will check to see if the associated Whisper has already been seen by this user. If it hasn&rsquo;t, the Whisper will be immediately presented to the user through an in-app notification that leads to the messaging interface when tapped. When you create a Whisper, Smooch will display a preview of this in-app notification.</p>
<pre class="highlight java"><code><span class="n">Smooch</span><span class="o">.</span><span class="na">track</span><span class="o">(</span><span class="s">"item-in-cart"</span><span class="o">);</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">Smooch</span><span class="p">.</span><span class="nx">track</span><span class="p">(</span><span class="s1">'item-in-cart'</span><span class="p">);</span>
</code></pre>
<pre class="highlight objective_c"><code><span class="p">[</span><span class="n">Smooch</span> <span class="nf">track</span><span class="p">:</span><span class="s">@"user-on-promopage"</span><span class="p">];</span>
</code></pre>
<pre class="highlight swift"><code><span class="kt">Smooch</span><span class="o">.</span><span class="nf">track</span><span class="p">(</span><span class="s">"user-on-promopage"</span><span class="p">);</span>
</code></pre>

<p>If the Whisper is not tied to an event, Smooch will monitor your userbase for changes and dispatch Whispers when a user&rsquo;s properties make them a fit for the target group of your Whisper. In many cases, this occurs when the user is not using your app. For instance, if you elect to send a Whisper to new users after 1 day has elapsed, Smooch will deliver the message approximately 24 hours after the user first used your app. If you choose to use this powerful method of Whisper delivery, ensure that you&rsquo;ve enabled push notifications for your app in Smooch. With push enabled, your users will receive a message that will bring them back into the conversation, even if they&rsquo;re not using your app.</p>

<p>Note that users need to be prompted and accept to receive push notifications. To make sure we don&rsquo;t prompt the user at a bad moment, Smooch will only request permission to send push notifications after a user sends his first message and only if the prompt wasn&rsquo;t shown earlier by your app. To get the full power of Whispers, we recommend you prompt for push permission as early as possible.</p>

          <h2 id='adding-user-actions-to-a-whisper'>Adding user actions to a Whisper</h2>
<p>You can prompt your users to take actions by adding action buttons to your Whisper. Clicking on &lsquo;Add an action&rsquo; will open up a new input box where you can specify the button text and what action to take when the user clicks on the button.</p>

<p><img alt="Whisper add action" src="../images/whisper_action.png" /></p>

<p>For more information on whisper actions, see <a href="#sending-action-buttons">this section</a> of the docs.</p>

          <h2 id='managing-whispers'>Managing Whispers</h2>
<p><img alt="Manage Whispers" src="../images/whisper_manage.png" /></p>

<p>Once you&rsquo;ve created a Whisper you can manage it from within the Smooch web interface. By clicking on the &ldquo;Whispers&rdquo; link in the navigation bar, you&rsquo;ll be presented with a list of Whispers as well as the number of users who have been exposed to them while running your app.</p>

<p>You can pause Whispers at any time. When you do so, the Whisper will not be shown to any more users until you mark it as active by clicking &ldquo;Resume&rdquo;.</p>

          <h1 id='localization'>Localization</h1>
<p>Every string you see in Smooch can be <a href="#strings-customization">customized</a> and localized. Smooch provides a few languages out of the box, but <a href="#adding-more-languages">adding new languages</a> is easy to do. When localizing strings, Smooch looks for values in the strings.xml in your app first then in the Smooch ui bundle, enabling you to customize any strings and add support for other languages.</p>
<h2 id='adding-more-languages'>Adding more languages</h2>
<p>To enable other languages beside the provided ones, first copy the english strings.xml file from the Smooch ui bundle to the corresponding values folder for that language. Then, translate the values to match that language.</p>

<p>If you translate Smooch&rsquo;s strings to a language not currently supported, we encourage you to share it with us so that every Smooch user can benefit from it. You can do so by <a href="https://github.com/smooch/smooch-android/fork">forking</a> our GitHub repo and creating a pull request, or just send us your string file at <a href="mailto:help@smooch.io">help@smooch.io</a></p>

          <h1 id='customization'>Customization</h1><h2 id='strings-customization'>Strings customization</h2>
<p>Smooch lets you customize any strings it displays by overwriting its keys. 
In order to do so, simply add <code class="prettyprint">res/values-&lt;your-language-code&gt;/strings.xml</code> file in your Android project and specify new values for the keys used in Smooch. You can find all available keys by browsing to the <code class="prettyprint">ui-x.x.x/res/values/values.xml</code> file in the External Libraries in Android Studio.</p>

<p>Dates shown in the conversation view are already localized to the user&rsquo;s device.</p>

<p>For example, if you wanted to override strings for English, you would create a file <code class="prettyprint">res/values-en/strings.xml</code> and include the following in that file:</p>
<pre class="highlight xml"><code><span class="nt">&lt;resources&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"Smooch_activityConversation"</span><span class="nt">&gt;</span>Messages<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"Smooch_startOfConversation"</span><span class="nt">&gt;</span>This is the start of your conversation with the team.<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"Smooch_welcome"</span><span class="nt">&gt;</span>Feel free to leave us a message about anything that\'s on your mind.<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"Smooch_messageHint"</span><span class="nt">&gt;</span>Type a message<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</code></pre>

<p><aside>Please note that if you want to specify new strings for the default fallback language, you must override them in <code class="prettyprint">res/values/string.xml</code>.</aside></p>

          <h2 id='styling-the-conversation-interface'>Styling the Conversation Interface</h2>
<p>Using a <code class="prettyprint">colors.xml</code> file in your <code class="prettyprint">res/values</code> folder, you can change the colors used by Smooch:</p>
<pre class="highlight xml"><code><span class="nt">&lt;resources&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_accent"</span><span class="nt">&gt;</span>#9200aa<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_accentDark"</span><span class="nt">&gt;</span>#76008a<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_accentLight"</span><span class="nt">&gt;</span>#be7cca<span class="nt">&lt;/color&gt;</span>

    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_backgroundInput"</span><span class="nt">&gt;</span>#ffffff<span class="nt">&lt;/color&gt;</span>

    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_btnSendHollow"</span><span class="nt">&gt;</span>#c0c0c0<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_btnSendHollowBorder"</span><span class="nt">&gt;</span>#303030<span class="nt">&lt;/color&gt;</span>

    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_header"</span><span class="nt">&gt;</span>#989898<span class="nt">&lt;/color&gt;</span>

    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_messageDate"</span><span class="nt">&gt;</span>@color/Smooch_header<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_messageShadow"</span><span class="nt">&gt;</span>#7f999999<span class="nt">&lt;/color&gt;</span>

    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_remoteMessageAuthor"</span><span class="nt">&gt;</span>@color/Smooch_header<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_remoteMessageBackground"</span><span class="nt">&gt;</span>#ffffff<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_remoteMessageBorder"</span><span class="nt">&gt;</span>#d9d9d9<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_remoteMessageText"</span><span class="nt">&gt;</span>#000000<span class="nt">&lt;/color&gt;</span>

    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_userMessageBackground"</span><span class="nt">&gt;</span>@color/Smooch_accent<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_userMessageBorder"</span><span class="nt">&gt;</span>@color/Smooch_accentDark<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_userMessageFailedBackground"</span><span class="nt">&gt;</span>@color/Smooch_accentLight<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">"Smooch_userMessageText"</span><span class="nt">&gt;</span>#ffffff<span class="nt">&lt;/color&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</code></pre>

<p>If you need to update the image of the Send button, simply add an image with the following name to your <code class="prettyprint">drawables</code>:</p>
<pre class="highlight plaintext"><code>smooch_btn_send_normal.png
</code></pre>

<p>You can find the original resources by browsing external libraries through Android Studio.</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
