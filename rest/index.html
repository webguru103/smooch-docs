<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Smooch API Reference</title>

    <link href="../images/favicon.ico" rel="icon" type="image/ico" />
    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <link href="../stylesheets/3col.css" rel="stylesheet" type="text/css" media="all" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../javascripts/all_nohacks.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["shell","javascript"]);
        });
      </script>
  </head>

  <body class="rest rest_index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/api_logo.png" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://smooch.io/'>Sign up for Smooch, it's free</a></li>
            <li><br/></li>
            <li><a href='/ios'>iOS Guide</a> | <a href='/api/ios'>Class Reference</a></li>
            <li><a href='/android'>Android Guide</a> | <a href='/api/android'>Class Reference</a></li>
            <li><a href='/javascript'>Web Guide</a> | <a href='https://github.com/smooch/smooch-js' target="_blank">Class Reference</a></li>
            <li><a href='/rest'>REST API Reference</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
    <div class="dark-box">
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
    </div>
      <div class="content">
        
              <h1 class="section-header" id="core">
                  Core
              </h1>
              <h1 id='introduction'>Introduction</h1>
<p>Welcome to the Smooch API. The API allows you to craft entirely unique messaging experiences for your app and website as well as talk to any backend or external service.</p>
<h2 id='basics'>Basics</h2>
<p>The Smooch API is designed according to <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST</a> principles.</p>

<p>The API accepts JSON in request bodies and requires that the <code class="prettyprint">content-type: application/json</code> header be specified for all such requests. The API will always respond with a JSON object. Depending on context, resources may be returned as single objects or as arrays of objects, nested within the response object.</p>

<p>The API also facilitates <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">cross-origin resource sharing</a> so that it can be called from a web application.</p>
<h2 id='errors'>Errors</h2><pre class="highlight plaintext"><code>401 Unauthorized
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unauthorized"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Authorization is required"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Smooch uses standard HTTP status codes to communicate errors</p>

<table><thead>
<tr>
<th></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>200</strong></td>
<td>OK - Everything went as planned.</td>
</tr>
<tr>
<td><strong>400</strong></td>
<td>Bad Request - Something in your header or request body was malformed.</td>
</tr>
<tr>
<td><strong>401</strong></td>
<td>Unauthorized - Necessary credentials were either missing or invalid.</td>
</tr>
<tr>
<td><strong>403</strong></td>
<td>Forbidden - Your credentials are valid but you don&rsquo;t have access to the requested resource.</td>
</tr>
<tr>
<td><strong>404</strong></td>
<td>Not Found - The object you&rsquo;re requesting doesn&rsquo;t exist.</td>
</tr>
<tr>
<td><strong>409</strong></td>
<td>Conflict - You might be trying to update the same resource concurrently.</td>
</tr>
<tr>
<td><strong>429</strong></td>
<td>Too Many Requests - You are calling our APIs more frequently than we allow.</td>
</tr>
<tr>
<td><strong>500, 502, 503, 504</strong></td>
<td>Server Errors - Something went wrong on our end.</td>
</tr>
</tbody></table>

<p>In addition to the status code, the HTTP body of the response will also contain a JSON representation of the error.</p>
<h2 id='rate-limits'>Rate Limits</h2>
<p>Smooch APIs are subject to rate limiting.  If you exceed the limits, Smooch will start returning a <code class="prettyprint">429 Too Many Requests</code> HTTP status code. We apply rate limits to prevent abuse, spam, denial-of-service attacks, and similar issues. Our goal is to keep the limits high enough so that any application using Smooch as intended will never hit them. However, applications that consistently exceed limits run the risk of being permanently disabled.</p>
<h2 id='deprecations'>Deprecations</h2>
<p>The &ldquo;devices&rdquo; array returned in the AppUser payload has been changed to &ldquo;clients&rdquo;. In order to maintain compatibility, we will keep returning the &ldquo;devices&rdquo; array in v1, but in the next version it will be removed.</p>
<h1 id='authorization'>Authorization</h1>
<p>This is an overview of how authorization works with the Smooch API.</p>

<p>Smooch offers two methods for authentication JSON Web Token (JWT) and app token. <a href="#authentication">See below</a> for more details. There are three different scopes of authorization available. These are <em>appUser</em>, <em>app</em>, and <em>appMaker</em>.</p>

<table><thead>
<tr>
<th>Scope</th>
<th>Methods</th>
<th>Authorized APIs</th>
</tr>
</thead><tbody>
<tr>
<td><strong>appUser</strong></td>
<td>JWT, appToken</td>
<td><a href="#init">Init</a>, <a href="#app-user">App User</a>, <a href="#conversations">Conversations</a></td>
</tr>
<tr>
<td><strong>app</strong></td>
<td>JWT</td>
<td><a href="#init">Init</a>, <a href="#app-user">App User</a>, <a href="#conversations">Conversations</a> <a href="#webhooks">Webhooks</a>, <a href="#persistent-menus">Persistent Menus</a></td>
</tr>
</tbody></table>

<p>The <strong>appToken</strong> authentication method only allows you to call the API on behalf of users who have not yet been secured by an app user scoped JWT.</p>

<p>JWTs issued with <strong>appUser</strong> scope grant the caller permission to access that specific user&rsquo;s data only. Once an app user JWT is used for the first time, the user and their conversation history will transition into secure mode, and from that point onward a JWT will be <em>required</em> for any subsequent API calls pertaining to that user. An <strong>appToken</strong> will no longer be accepted to access that specific user&rsquo;s data.</p>

<p>JWTs issued with <strong>app</strong> scope can be used to access any of the Smooch Core APIs on behalf of the app, or any app user.</p>
<h1 id='authentication'>Authentication</h1>
<p>Smooch APIs offer two methods of authentication:</p>

<ol>
<li>Using an <a href="#app-token">App Token</a></li>
<li>Using a <a href="#jwt">JSON Web Token (JWT)</a></li>
</ol>

<p>Some APIs accept either of the two authentication methods while others require a <code class="prettyprint">jwt</code> credential.</p>

<table><thead>
<tr>
<th>API</th>
<th>Valid authentication methods</th>
</tr>
</thead><tbody>
<tr>
<td><a href="#app-user"><code class="prettyprint">/v1/appusers</code></a></td>
<td><code class="prettyprint">jwt</code>, <code class="prettyprint">appToken</code></td>
</tr>
<tr>
<td><a href="#init"><code class="prettyprint">/v1/init</code></a></td>
<td><code class="prettyprint">jwt</code>, <code class="prettyprint">appToken</code></td>
</tr>
<tr>
<td><a href="#webhook"><code class="prettyprint">/v1/webhooks</code></a></td>
<td><code class="prettyprint">jwt</code></td>
</tr>
</tbody></table>
<h2 id='app-token'>App Token</h2><pre class="highlight shell"><code><span class="c"># Calling GET /v1/appusers using an app token</span>
curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// Initializing Smooch Core with an app token</span>
<span class="kd">var</span> <span class="nx">smooch</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SmoochCore</span><span class="p">({</span>
    <span class="na">appToken</span><span class="p">:</span> <span class="s1">'cr2g6jgxrahuh68n1o3e2fcnt'</span>
<span class="p">});</span>
</code></pre>

<p>When calling Smooch APIs such as <a href="#app-users"><code class="prettyprint">/v1/appusers</code></a> on behalf of app users, an <code class="prettyprint">appToken</code> may be used for basic authentication.</p>

<p>Every Smooch app has an <code class="prettyprint">appToken</code> provisioned to it which can be found in the app settings tab. The <code class="prettyprint">appToken</code> is sent via the the <code class="prettyprint">app-token</code> HTTP header. This will link the caller to a specific Smooch app.</p>

<p>Specifying an <code class="prettyprint">appToken</code> alone is sufficient to call any of the app user facing API.</p>
<h2 id='jwt'>JWT</h2><pre class="highlight shell"><code><span class="c"># Calling GET /v1/appusers using a jwt</span>
curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// Initializing Smooch Core with a jwt in the browser</span>
<span class="kd">var</span> <span class="nx">smooch</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SmoochCore</span><span class="p">({</span>
    <span class="na">jwt</span><span class="p">:</span> <span class="s1">'your-jwt'</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// Initializing Smooch Core with a jwt in Node.js</span>
<span class="kd">var</span> <span class="nx">smooch</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SmoochCore</span><span class="p">({</span>
    <span class="na">keyId</span><span class="p">:</span> <span class="s1">'your-key-id'</span><span class="p">,</span>
    <span class="na">secret</span><span class="p">:</span> <span class="s1">'your-secret'</span><span class="p">,</span>
    <span class="na">scope</span><span class="p">:</span> <span class="s1">'appUser'</span><span class="p">,</span> <span class="c1">// app or appUser</span>
    <span class="na">userId</span><span class="p">:</span> <span class="s1">'some-id'</span> <span class="c1">// not necessary if scope === 'app'</span>
<span class="p">});</span>
</code></pre>

<p>JSON Web Tokens (JWTs) are an industry standard authentication mechanism. The full specification is described <a href="https://tools.ietf.org/html/rfc7519">here</a>, and a set of supported JWT libraries for a variety of languages and platforms can be found at <a href="http://jwt.io">http://jwt.io</a>. To summarize, a JWT is composed of a header, a payload, and a signature. The payload contains information called <em>claims</em> which describe the subject to whom the token was issued.</p>

<p>For added security when making calls on behalf of an app user, a <code class="prettyprint">jwt</code> credential can optionally be specified instead of an <code class="prettyprint">appToken</code>.</p>

<p>The <code class="prettyprint">jwt</code> itself is transmitted via the HTTP <code class="prettyprint">authorization</code> header. The token should be prefixed with &ldquo;Bearer&rdquo; followed by a space. For example: <code class="prettyprint">Bearer your-jwt</code>.</p>

<p>To sign JWTs, you will need to create a secret key in the Smooch dashboard, by going into the Settings tab. Clicking on &ldquo;Create New Secret Key&rdquo; will generate a new key id and a secret key pair which you can use to sign JWTs.</p>

<p><aside class="warning">
After using a <code class="prettyprint">jwt</code> with <code class="prettyprint">appUser</code> scope to authenticate an app user for the <code class="prettyprint">/appuser</code> or <code class="prettyprint">/init</code> routes, it becomes no longer possible to authenticate that app user with an <code class="prettyprint">appToken</code>.
</aside></p>
<h3 id='header'>Header</h3>
<blockquote>
<p>JWT header:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"alg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HS256"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"typ"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JWT"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"kid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b567635f883c819871ace8003c0db14b"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>The JWT header must contain the key id (<code class="prettyprint">kid</code>) of the secret key that is used to sign it. The algorithm (<code class="prettyprint">alg</code>) used to sign the JWT can be anything supported by the <a href="https://www.npmjs.com/package/jsonwebtoken#algorithms-supported">jsonwebtoken npm module v5.0.4</a>. Unsigned JWTs are not accepted.</p>

<blockquote>
<p>JWT payload with <code class="prettyprint">appUser</code> scope claim:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appUser"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bob@example.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>JWT payload with <code class="prettyprint">app</code> scope:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id='scope'>Scope</h3>
<p>The <code class="prettyprint">jwt</code> payload must include a <code class="prettyprint">scope</code> claim which specifies the caller&rsquo;s scope of access. There are two levels of scope:</p>

<ol>
<li><p>The <code class="prettyprint">appUser</code> scope grants access to an individual app user&rsquo;s data and conversation history, but nothing else. It is used when issuing tokens to individual users. A <code class="prettyprint">jwt</code> with <code class="prettyprint">appUser</code> scope must also specify a <code class="prettyprint">userId</code> which uniquely identifies the <code class="prettyprint">appUser</code> being accessed. <a href="https://gist.github.com/alavers/8f07b03895333d83b454">Node.js code sample</a></p></li>
<li><p>The <code class="prettyprint">app</code> scope grants access to all users and conversations within a given Smooch app. The <code class="prettyprint">app</code> scope is reserved for server-to-server scenarios, the creation of webhooks for example. <a href="https://gist.github.com/alavers/d9af102ca4cefac1a7e5">Node.js code sample</a></p></li>
</ol>

<table><thead>
<tr>
<th>API</th>
<th>Accepted <code class="prettyprint">jwt</code> Scopes</th>
</tr>
</thead><tbody>
<tr>
<td><a href="#app-user">/v1/appusers</a></td>
<td>app, appUser</td>
</tr>
<tr>
<td><a href="#webhook">/v1/webhooks</a></td>
<td>app</td>
</tr>
</tbody></table>
<h1 id='webhooks'>Webhooks</h1>
<p>Webhooks are a fantastic way to extend the Smooch platform beyond the built-in feature set. You can use webhooks to build your own Smooch chat clients, to integrate more deeply with your favorite CRM, or to <a href="https://github.com/smooch/smooch-bot">build a bot</a>.</p>

<p>These webhook APIs require a <code class="prettyprint">jwt</code> credential with <code class="prettyprint">app</code> level scope. Furthermore, a webhook can only operate within the scope of a single Smooch app.</p>

<p>When a webhook trigger is triggered, a JSON payload will be posted to the URL configured in your webhook object. You can see an example of this payload <a href="#webhooks-payload">here</a>.</p>
<h2 id='create-webhook'>Create webhook</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/webhooks <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"target": "http://example.com/callback"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
    <span class="na">target</span><span class="p">:</span> <span class="s1">'http://example.com/callback'</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"webhook"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8d9758590aa1900b9b9f6"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"triggers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"message"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8564b3e6a8b20a4bdb68b05d9ea97aace9bc5936"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com/callback"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/webhooks</code></api></p>

<p>Create a webhook for the specified app. The response body will include a secret which will be transmitted with each webhook invocation and can be used to verify the authenticity of the caller.</p>

<p>Alternatively, you can use the Webhooks integration in the Smooch dashboard to easily create a webhook.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>target</strong><br/><span class='req'>required</span></td>
<td>URL to be called when the webhook is triggered.</td>
</tr>
<tr>
<td><strong>triggers</strong><br/><span class='opt'>optional</span></td>
<td>An array of triggers you wish to have the webhook listen to. If unspecified the default trigger is <code class="prettyprint">message</code>. This property is case sensitive. <a href="#webhook-triggers">More details</a>.</td>
</tr>
</tbody></table>
<h2 id='list-webhooks'>List webhooks</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/webhooks <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">list</span><span class="p">().</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"webhooks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8d9758590aa1900b9b9f6"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"triggers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"message"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8564b3e6a8b20a4bdb68b05d9ea97aace9bc5936"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com/callback"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/webhooks</code></api></p>

<p>List all webhooks configured for a given app.</p>
<h2 id='get-webhook'>Get webhook</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/webhooks/55c8d9758590aa1900b9b9f6 <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'55c8d9758590aa1900b9b9f6'</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"webhook"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8d9758590aa1900b9b9f6"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"triggers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"message"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8564b3e6a8b20a4bdb68b05d9ea97aace9bc5936"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com/callback"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/webhooks/{webhookId}</code></api></p>

<p>Individual webhooks can be fetched using this API.</p>
<h2 id='update-webhook'>Update webhook</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/webhooks/55c8d9758590aa1900b9b9f6 <span class="se">\</span>
     -X PUT <span class="se">\</span>
     -d <span class="s1">'{"target": "http://example.com/callback"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s1">'55c8d9758590aa1900b9b9f6'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">target</span><span class="p">:</span> <span class="s1">'http://example.com/callback'</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"webhook"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8d9758590aa1900b9b9f6"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"triggers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"message"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8564b3e6a8b20a4bdb68b05d9ea97aace9bc5936"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com/callback"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">PUT /v1/webhooks/{webhookId}</code></api></p>

<p>Use this API to update your existing webhooks.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>target</strong><br/><span class='opt'>optional</span></td>
<td>URL to be called when the webhook is triggered.</td>
</tr>
<tr>
<td><strong>triggers</strong><br/><span class='opt'>optional</span></td>
<td>The triggers you wish to have the webhook listen to. The default trigger is <code class="prettyprint">message</code>. This property is case sensitive. <a href="#webhook-triggers">More details</a>.</td>
</tr>
</tbody></table>
<h2 id='delete-webhook'>Delete webhook</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/webhooks/55c8d9758590aa1900b9b9f6 <span class="se">\</span>
     -X DELETE <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'55c8d9758590aa1900b9b9f6'</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>

<p><api><code class="prettyprint">DELETE /v1/webhooks/{webhookId}</code></api></p>

<p>Deletes the specified webhook.</p>
<h2 id='webhook-triggers'>Webhook triggers</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/webhooks
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"target": "http://example.com/callback", "triggers": ["message:appUser"]}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">webhooks</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
    <span class="na">target</span><span class="p">:</span> <span class="s1">'http://example.com/callback'</span><span class="p">,</span>
    <span class="na">triggers</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'message:appUser'</span>
    <span class="p">]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<p>A webhook will make a request to the target each time a trigger associated with the webhook occurs. Triggers are specified in an optional <code class="prettyprint">triggers</code> array in the request body. If <code class="prettyprint">triggers</code> is not specified the webhook will be configured with the <code class="prettyprint">message</code> trigger by default.</p>

<p>A webhook with a <code class="prettyprint">postback</code> trigger will be fired every time a user clicks on <a href="#action-buttons">an action button with type <code class="prettyprint">postback</code></a>.</p>

<table><thead>
<tr>
<th>trigger</th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>message</strong><br/><em>default</em></td>
<td>all messages</td>
</tr>
<tr>
<td><strong>message:appUser</strong></td>
<td>only messages with role <code class="prettyprint">appUser</code></td>
</tr>
<tr>
<td><strong>message:appMaker</strong></td>
<td>only messages with role <code class="prettyprint">appMaker</code> or <code class="prettyprint">whisper</code></td>
</tr>
<tr>
<td><strong>conversation:read</strong></td>
<td>when a user reads a conversation</td>
</tr>
<tr>
<td><strong>postback</strong></td>
<td>when a user clicks on a postback action</td>
</tr>
<tr>
<td><strong>merge:appUser</strong></td>
<td>when two or more users are merged into one</td>
</tr>
<tr>
<td><strong>delivery:success</strong></td>
<td>when a message is successfully delivered to a customer channel</td>
</tr>
<tr>
<td><strong>delivery:failure</strong></td>
<td>when a message fails to be delivered to a customer channel</td>
</tr>
<tr>
<td><strong>*</strong></td>
<td>when any of the above triggers occurs</td>
</tr>
</tbody></table>
<h2 id='webhooks-payload'>Webhooks payload</h2>
<blockquote>
<p>Webhook example payload for <code class="prettyprint">message</code>, <code class="prettyprint">message:appMaker</code> and <code class="prettyprint">message:appUser</code> triggers:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"message:appUser"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5698edbf2a43bd081be982f1"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"messages"</span><span class="p">:[{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8c1498590aa1900b9b9b1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi! Do you have time to chat?"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appUser"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"authorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c7f6e6d6c3a637261bd9656f"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="mf">1444348338.704</span><span class="p">,</span><span class="w">
        </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"messenger"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c7f6e6d6c3a637261bd9656f"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bob@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"signedUpAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-06T03:38:02.346Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"clients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"appVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5A7F8343-DF41-46A8-96EC-8583FCB422FB"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastSeen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-09T19:09:01.431Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ios"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pushNotificationToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;...&gt;"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"appName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ShellApp"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"devicePlatform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x86_64"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iPhone OS"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"osVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.2"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Webhook example payload for the <code class="prettyprint">postback</code> trigger:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5698edbf2a43bd081be982f1"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"postbacks"</span><span class="p">:[{</span><span class="w">
        </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8c1498590aa1900b9b9b1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Do you want to see more options?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appMaker"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c7f6e6d6c3a637261bd9656f"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LunchBot"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="mf">1444348338.704</span><span class="p">,</span><span class="w">
            </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"slack"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
                </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"571530ee4fae94c32b78b170"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yes"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YES"</span><span class="w">
            </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"571530ee4fae94c32b78b171"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NO"</span><span class="w">
            </span><span class="p">}]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"571530ee4fae94c32b78b170"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Read more"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YES"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c7f6e6d6c3a637261bd9656f"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bob@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"signedUpAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-06T03:38:02.346Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"clients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5A7F8343-DF41-46A8-96EC-8583FCB422FB"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastSeen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-09T19:09:01.431Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"telegram"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Webhook example payload for the <code class="prettyprint">postback</code> trigger originating from a menu:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5698edbf2a43bd081be982f1"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"postbacks"</span><span class="p">:[{</span><span class="w">
        </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"571530ee4fae94c32b78b170"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Read more"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YES"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c7f6e6d6c3a637261bd9656f"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bob@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"signedUpAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-06T03:38:02.346Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"clients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5A7F8343-DF41-46A8-96EC-8583FCB422FB"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastSeen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-09T19:09:01.431Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"telegram"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Webhook example payload for the <code class="prettyprint">conversation:read</code> trigger:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"conversation:read"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57ec2881c47d2d24b0c16427"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"messenger"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7685787bf0e9e8cf56182288"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mf">1480349392.103</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Webhook example payload for the <code class="prettyprint">merge:appUser</code> trigger:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"merge:appUser"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5698edbf2a43bd081be982f1"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"surviving"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a79a0ecfba3260bf145be257"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"conversationStarted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"discarded"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1ac30dad829178f6378f61f4"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"conversationStarted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Webhook example payload for the <code class="prettyprint">delivery:success</code> trigger:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"delivery:success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"575040549a38df8fb4eb1e51"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"de13bee15b51033b34162411"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"destination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"line"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi! Do you have time to chat?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="mf">1480001439.637</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Danny"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appMaker"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5X8AJwvpy0taCkPDniC5la"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"avatarUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.gravatar.com/image.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5837079fd84370ef2c0dcabb"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"slack"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mf">1480001440.731</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Webhook example payload for the <code class="prettyprint">delivery:failure</code> trigger:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"delivery:failure"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"575040549a38df8fb4eb1e51"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"de13bee15b51033b34162411"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"destination"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"line"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unauthorized"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"underlyingError"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Authentication failed due to the following reason: invalid token. Confirm that the access token in the authorization header is valid."</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi! Do you have time to chat?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="mf">1480001711.288</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Danny"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appMaker"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"authorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5X8AJwvpy0taCkPDniC5la"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"avatarUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.gravatar.com/image.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"583708af8d449209ba217871"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"slack"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mf">1480001711.941</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>When a webhook trigger is triggered, a <code class="prettyprint">POST</code> request will be made to the URL configured in your webhook object along with a JSON payload.</p>

<p>The structure of the JSON payload differs based on the trigger of the webhook. On the right, you can see examples of the JSON payload for the different triggers. Postbacks originating from a <a href="#persistent-menus">persistent menu</a> do not have messages associated with them, and so omit the message property.</p>
<h2 id='securing-a-webhook'>Securing a webhook</h2>
<p>When a webhook is created, a shared secret will be generated for it. The secret can be used to determine the veracity of a request to your webhook route. It is included as an <code class="prettyprint">X-API-Key</code> header with each webhook request sent to the target URL.</p>

<p>That secret is available in the response to the POST request used to generate the webhook, or through a GET request to the webhook route.</p>
<h2 id='retry-policy'>Retry Policy</h2>
<p>If a webhook target responds with anything other than a 2xx status code, or if no response is received within 5 seconds, the call will be reattempted up to 5 times at an exponentially increasing interval.</p>
<h1 id='init'>Init</h1>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/init <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"device": {"id": "03f70682b7f5b21536a3674f38b3e220", "platform": "ios", "appVersion": "1.0"}, "userId": "bob@example.com"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
    <span class="na">device</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="s1">'03f70682b7f5b21536a3674f38b3e220'</span><span class="p">,</span>
        <span class="na">platform</span><span class="p">:</span> <span class="s1">'ios'</span><span class="p">,</span>
        <span class="na">appVersion</span><span class="p">:</span> <span class="s1">'1.0'</span>
    <span class="p">},</span>
    <span class="na">userId</span><span class="p">:</span> <span class="s1">'bob@example.com'</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"hasIcon"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"apnEnabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"gcmProject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"731399543244"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c7f6e6d6c3a637261bd9656f"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bob@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"signedUpAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-06T03:38:02.346Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"clients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"appVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5A7F8343-DF41-46A8-96EC-8583FCB422FB"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastSeen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-09T19:09:01.431Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ios"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pushNotificationToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;...&gt;"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"appName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ShellApp"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"devicePlatform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x86_64"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iPhone OS"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"osVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.2"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/init</code></api></p>

<p>This API is called by a mobile device or browser when the app is first loaded. It serves a number of purposes:</p>

<ol>
<li>Initializes a new <code class="prettyprint">appUser</code> and <code class="prettyprint">device</code> if they don&rsquo;t yet exist</li>
<li>Updates an existing app user&rsquo;s profile and device information</li>
<li>Authenticates the <code class="prettyprint">appUser</code> if <code class="prettyprint">jwt</code> credentials are provided</li>
</ol>

<p>The API requires that a <code class="prettyprint">device</code> be specified at the very minimum. A <code class="prettyprint">userId</code> may also be specified to <a href="/#users-on-multiple-devices">link app user accounts across devices</a>.</p>

<p>The API responds with an <code class="prettyprint">appUser</code> object. The <code class="prettyprint">appUser</code> includes an <code class="prettyprint">_id</code> that can be used to make further API calls on behalf of that user. If the <code class="prettyprint">userId</code> and/or <code class="prettyprint">device.id</code> are seen for the first time a new <code class="prettyprint">appUser</code> will be created. If not, the existing <code class="prettyprint">appUser</code> be returned.</p>

<p>An <code class="prettyprint">app</code> object is also returned which includes metadata about the app, such as information about push notification channels.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>device</strong><br/><span class='req'>required</span></td>
<td>A descriptor of the user&rsquo;s device. See below.</td>
</tr>
<tr>
<td><strong>userId</strong><br/><span class='opt'>optional</span></td>
<td>A unique identifier for the app user. Unlike the <code class="prettyprint">smoochId</code> which is generated by Smooch, the <code class="prettyprint">userId</code> is chosen by the API consumer. The <code class="prettyprint">userId</code> can be used to link a user to the same conversation <a href="/#users-on-multiple-devices">across multiple devices</a>.</td>
</tr>
</tbody></table>

<p><aside class="warning">
<strong>Caution:</strong> If you&rsquo;re specifying a <code class="prettyprint">userId</code> then in order to keep conversations private we strongly suggest <a href="/#authenticating-users-optional">authenticating your users</a>. If a <code class="prettyprint">userId</code> is used without a JWT credential, then anyone who can discover a user&rsquo;s <code class="prettyprint">userId</code> could potentially eavesdrop on the conversation.
</aside></p>
<h2 id='device'>Device</h2>
<p>If a <code class="prettyprint">userId</code> is used when calling <code class="prettyprint">/v1/init</code>, then devices and app users may have a many-to-many relationship. A single <code class="prettyprint">userId</code> may use Smooch from multiple devices and multiple different <code class="prettyprint">userId</code>s may log in to the same device.</p>

<p><aside class="notice">
<em>Note:</em> Only one <code class="prettyprint">userId</code> can be active on a given device at a time. On a device that&rsquo;s shared between multiple <code class="prettyprint">userId</code>s, only the most recent <code class="prettyprint">userId</code> to have called <code class="prettyprint">/v1/init</code> will receive push notifications from the integrated application on that device.
</aside></p>

<table><thead>
<tr>
<th><strong><code class="prettyprint">device</code> arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>id</strong><br/><span class='req'>required</span></td>
<td>An identifier for the device. Must be globally unique.</td>
</tr>
<tr>
<td><strong>platform</strong><br/><span class='req'>required</span></td>
<td><code class="prettyprint">ios</code>, <code class="prettyprint">android</code>, <code class="prettyprint">web</code>, or <code class="prettyprint">other</code></td>
</tr>
<tr>
<td><strong>pushNotificationToken</strong><br/><span class='opt'>optional</span></td>
<td>The GCM or APN token to be used for sending push notifications to the device.</td>
</tr>
<tr>
<td><strong>appVersion</strong><br/><span class='opt'>optional</span></td>
<td>A reserved string field for reporting the app version running on the device. For example: <code class="prettyprint">8.0</code></td>
</tr>
<tr>
<td><strong>info</strong><br/><span class='opt'>optional</span></td>
<td>A flat JSON structure detailing device properties. See below.</td>
</tr>
</tbody></table>
<h2 id='device-info'>Device Info</h2>
<p>The <code class="prettyprint">device</code> object may also accept a flat <code class="prettyprint">info</code> JSON object. Device information reported here will be rendered alongside app user information inside any app maker channels configured with Smooch. The <code class="prettyprint">platform</code> and <code class="prettyprint">appVersion</code> fields are special in that they can be used as audience targeting criteria for whispers.</p>

<table><thead>
<tr>
<th>Field</th>
<th>Example</th>
<th>Relevant Platforms</th>
</tr>
</thead><tbody>
<tr>
<td><strong>appName</strong></td>
<td><code class="prettyprint">foo</code></td>
<td>ios, android</td>
</tr>
<tr>
<td><strong>deviceModel</strong></td>
<td><code class="prettyprint">iPhone 5s</code></td>
<td>ios, android</td>
</tr>
<tr>
<td><strong>os</strong></td>
<td><code class="prettyprint">iPhone OS</code></td>
<td>ios, android</td>
</tr>
<tr>
<td><strong>osVersion</strong></td>
<td><code class="prettyprint">8.1.2</code></td>
<td>ios, android</td>
</tr>
<tr>
<td><strong>radioAccessTechnology</strong></td>
<td><code class="prettyprint">HSDPA</code></td>
<td>ios, android</td>
</tr>
<tr>
<td><strong>carrier</strong></td>
<td><code class="prettyprint">Acme</code></td>
<td>ios, android</td>
</tr>
<tr>
<td><strong>devicePlatform</strong></td>
<td><code class="prettyprint">iPhone6,1</code></td>
<td>ios, android</td>
</tr>
<tr>
<td><strong>wifi</strong></td>
<td><code class="prettyprint">YES</code></td>
<td>ios, android</td>
</tr>
<tr>
<td><strong>currentUrl</strong></td>
<td><code class="prettyprint">http://mywebsite.com</code></td>
<td>web</td>
</tr>
<tr>
<td><strong>userAgent</strong></td>
<td><code class="prettyprint">Mozilla/5.0...</code></td>
<td>web</td>
</tr>
<tr>
<td><strong>referrer</strong></td>
<td><code class="prettyprint">http://google.com</code></td>
<td>web</td>
</tr>
<tr>
<td><strong>browserLanguage</strong></td>
<td><code class="prettyprint">en-US</code></td>
<td>web</td>
</tr>
<tr>
<td><strong>currentTittle</strong></td>
<td><code class="prettyprint">Welcome</code></td>
<td>web</td>
</tr>
</tbody></table>

<p>The API will respond with the <code class="prettyprint">_id</code> of the app user in question, which can then be used to make API calls to the conversation API. The response will also include any profile information that was previously set for the app user, including custom properties.</p>

<p><aside class="notice">
In some scenarios, the <code class="prettyprint">appUser._id</code> returned in an app boot call may change. This is possible for example when the <code class="prettyprint">userId</code> is being used to log a user in on multiple devices, which may cause two distinct app users to merge together. The caller should always check if the returned <code class="prettyprint">appUser._id</code> has changed, and re-fetch conversation history whenever appropriate.
</aside></p>
<h1 id='app-user'>App User</h1>
<p>The app user object represents an end user using your app. The app user document contains basic profile information such as <code class="prettyprint">givenName</code>, <code class="prettyprint">surname</code>, and <code class="prettyprint">email</code>, as well as any custom user properties you choose to configure.</p>

<p>The <code class="prettyprint">/v1/appusers</code> path gives you APIs that can be used to update the user&rsquo;s properties, retrieve conversation history, post a message, and track app user events.</p>
<h3 id='userid'>userId</h3>
<p>App users may be created with an optional <code class="prettyprint">userId</code> parameter. This is a unique identifier that is chosen by the API consumer and it can be used to synchronize a single conversation across multiple devices. To understand how this works, see the section covering <a href="/#users-on-multiple-devices">users on multiple devices</a>.</p>

<p><aside class="notice">
If a <code class="prettyprint">userId</code> has been specified for a given app user, it can be used in place of the <code class="prettyprint">appUser._id</code> in any <code class="prettyprint">/v1/appusers/</code> API path.
</aside></p>
<h2 id='get-app-user'>Get App User</h2>
<blockquote>
<p>Request by smoochId:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Request by userId:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/steveb@channel5.com <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'steveb@channel5.com'</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deb920657bbc3adc3fec7963"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"steveb@channel5.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"givenName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"surname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Brule"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"steveb@channel5.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"signedUpAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-08T23:52:11.677Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"conversationStarted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"clients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"appVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5A7F8343-DF41-46A8-96EC-8583FCB422FB"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastSeen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-09T19:09:01.431Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ios"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pushNotificationToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;...&gt;"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"appName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ShellApp"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"devicePlatform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x86_64"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iPhone OS"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"osVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.2"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/appusers/{smoochId|userId}</code></api></p>

<p>Retrieve a specific app user. Like all other <code class="prettyprint">/v1/appusers/</code> paths, an app user can be identified using either the <code class="prettyprint">smoochId</code> or the <code class="prettyprint">userId</code>.</p>
<h2 id='update'>Update</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f <span class="se">\</span>
     -X PUT <span class="se">\</span>
     -d <span class="s1">'{"givenName": "Steve"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">givenName</span><span class="p">:</span> <span class="s1">'Steve'</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deb920657bbc3adc3fec7963"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"steveb@channel5.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"givenName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"surname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Brule"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"steveb@channel5.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"signedUpAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-08T23:52:11.677Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="s2">"conversationStarted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"clients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"appVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5A7F8343-DF41-46A8-96EC-8583FCB422FB"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"lastSeen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-09T19:09:01.431Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ios"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"pushNotificationToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;...&gt;"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"appName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ShellApp"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"devicePlatform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x86_64"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iPhone OS"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"osVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.2"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">PUT /v1/appusers/{smoochId|userId}</code></api></p>

<p>Update an app user&rsquo;s basic profile information and specify custom profile data via <code class="prettyprint">properties</code>. This API is additive; only the specific fields specified in the request body, and only the specific JSON sub-fields included in the <code class="prettyprint">properties</code> field will be updated. In other words, omitting a field will not delete that field.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>givenName</strong><br/><span class='opt'>optional</span></td>
<td>The user&rsquo;s given name (first name).</td>
</tr>
<tr>
<td><strong>surname</strong><br/><span class='opt'>optional</span></td>
<td>The user&rsquo;s surname (last name).</td>
</tr>
<tr>
<td><strong>email</strong><br/><span class='opt'>optional</span></td>
<td>The user&rsquo;s email address.</td>
</tr>
<tr>
<td><strong>signedUpAt</strong><br/><span class='opt'>optional</span></td>
<td>The date at which the user signed up. Must be ISO 8601 time format (<code class="prettyprint">YYYY-MM-DDThh:mm:ss.sssZ</code>)</td>
</tr>
<tr>
<td><strong>properties</strong><br/><span class='opt'>optional</span></td>
<td>A flat JSON object containing custom defined user properties.</td>
</tr>
</tbody></table>
<h2 id='update-device'>Update Device</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/devices/5A7F8343-DF41-46A8-96EC-8583FCB422FB <span class="se">\</span>
     -X PUT <span class="se">\</span>
     -d <span class="s1">'{"appVersion": "8.0"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">updateDevice</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="s1">'5A7F8343-DF41-46A8-96EC-8583FCB422FB'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">appVersion</span><span class="p">:</span> <span class="s1">'8.0'</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"device"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"appVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5A7F8343-DF41-46A8-96EC-8583FCB422FB"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"lastSeen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-09T19:09:01.431Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ios"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pushNotificationToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;...&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"appName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ShellApp"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"devicePlatform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x86_64"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iPhone OS"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"osVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.2"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">PUT /v1/appusers/{smoochId|userId}/devices/{deviceId}</code></api></p>

<p>Update the properties of a device. This API is additive; only the specific fields specified in the request body, and only the specific JSON sub-fields included in the <code class="prettyprint">info</code> field will be updated. In other words, omitting a field will not delete that field.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>pushNotificationToken</strong><br/><span class='opt'>optional</span></td>
<td>The GCM or APN token to be used for sending push notifications to the device.</td>
</tr>
<tr>
<td><strong>appVersion</strong><br/><span class='opt'>optional</span></td>
<td>A reserved string field for reporting the app version running on the device. For example: <code class="prettyprint">8.0</code></td>
</tr>
<tr>
<td><strong>info</strong><br/><span class='opt'>optional</span></td>
<td>A flat JSON structure detailing device properties. See <a href="#device-info">Device Info</a>.</td>
</tr>
</tbody></table>
<h2 id='track-event'>Track Event</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/events <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"name":"completed_sale"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">trackEvent</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="s1">'completed_sale'</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"conversationUpdated"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/appusers/{smoochId|userId}/events</code></api></p>

<p>Trigger an event for a given app user. Some Smooch whispers are triggered on discrete events. This API is used to trigger such events. For example, if an app has a whisper configured to be sent whenever a user has triggered the <code class="prettyprint">completed_sale</code> event, calling this API is the way to trigger such a whisper.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>name</strong><br/><span class='req'>required</span></td>
<td>The name of the triggered event.</td>
</tr>
</tbody></table>
<h2 id='pre-create-app-user'>Pre-Create App User</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"userId": "steveb@channel5.com", "givenName": "Steve", "properties": {"favoriteFood": "prizza"}}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'steveb@channel5.com'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">givenName</span><span class="p">:</span> <span class="s1">'Steve'</span><span class="p">,</span>
    <span class="na">properties</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">favoriteFood</span><span class="p">:</span> <span class="s1">'prizza'</span>
    <span class="p">}</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deb920657bbc3adc3fec7963"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"steveb@channel5.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"givenName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"signedUpAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-08T23:52:11.677Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"favoriteFood"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prizza"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"conversationStarted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"credentialRequired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/appusers</code></api></p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>userId</strong><br/><span class='req'>required</span></td>
<td>A unique identifier for the app user. The <code class="prettyprint">userId</code> can be used to link a user to the same conversation <a href="/#users-on-multiple-devices">across multiple devices</a>.</td>
</tr>
<tr>
<td><strong>credentialRequired</strong><br/><span class='opt'>optional</span></td>
<td>Default is <code class="prettyprint">false</code>. Set to <code class="prettyprint">true</code> to ensure that the created app user requires a <code class="prettyprint">jwt</code> credential. See <a href="/#authenticating-users-optional">authenticating your users</a> for more information.</td>
</tr>
<tr>
<td><strong>givenName</strong><br/><span class='opt'>optional</span></td>
<td>The user&rsquo;s given name (first name).</td>
</tr>
<tr>
<td><strong>surname</strong><br/><span class='opt'>optional</span></td>
<td>The user&rsquo;s surname (last name).</td>
</tr>
<tr>
<td><strong>email</strong><br/><span class='opt'>optional</span></td>
<td>The user&rsquo;s email address.</td>
</tr>
<tr>
<td><strong>signedUpAt</strong><br/><span class='opt'>optional</span></td>
<td>The date at which the user signed up. Must be ISO 8601 time format (<code class="prettyprint">YYYY-MM-DDThh:mm:ss.sssZ</code>)</td>
</tr>
<tr>
<td><strong>properties</strong><br/><span class='opt'>optional</span></td>
<td>A flat JSON object containing custom defined user properties.</td>
</tr>
</tbody></table>

<p>In the vast majority of cases app users will be created from the device or browser using the <a href="#init">init API</a>. In some cases however it might be necessary to pre-create an app user object before that user runs your app for the first time. This API facilitates this scenario. A <code class="prettyprint">userId</code> must be specified so that a future <code class="prettyprint">init</code> call made from a device can use the same <code class="prettyprint">userId</code> to link the device to the pre-created app user.</p>

<p>Suppose for example you begin a conversation with an end user <code class="prettyprint">bob@example.com</code> over email and you wish to transfer this conversation history over into Smooch once that user logs in to your app. To facilitate this, you can call <code class="prettyprint">POST /v1/appusers</code> to pre-create a Smooch identity with <code class="prettyprint">userId</code> <code class="prettyprint">bob@example.com</code>, to which you can import that existing conversation history. After Bob signs in to your app and your app calls <code class="prettyprint">init</code> with the same <code class="prettyprint">userId</code>, they will see their conversation history.</p>

<p><aside class="notice">
Unlike the other App User APIs in this section, this endpoint is not intended to be called from an end user device or from a browser. It requires a <code class="prettyprint">jwt</code> credential with <code class="prettyprint">app</code> level scope.
</aside></p>
<h2 id='link-app-user-to-channel'>Link App User To Channel</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/deb920657bbc3adc3fec7963/channels <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"type": "twilio", "phoneNumber": "+15145555555"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">linkChannel</span><span class="p">(</span><span class="s1">'steveb@channel5.com'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'twilio'</span><span class="p">,</span>
    <span class="na">phoneNumber</span><span class="p">:</span> <span class="s1">'+15145555555'</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"appUser"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deb920657bbc3adc3fec7963"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"steveb@channel5.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"givenName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"signedUpAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-08T23:52:11.677Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"favoriteFood"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pizza"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"conversationStarted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"credentialRequired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"clients"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"pendingClients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d383f9f4-c8d2-42dd-9f7c-f525fad6849d"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"twilio"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"displayName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+15145555555"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/appusers/{smoochId|userId}/channels</code></api></p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The channel to link.</td>
</tr>
<tr>
<td><strong>{entity}</strong><br/><span class='req'>required</span></td>
<td>The required entity for linking. This is <a href="#linkable-channels-and-entities">different for each channel</a>.</td>
</tr>
<tr>
<td><strong>skipConfirmation</strong><br/><span class='opt'>optional</span></td>
<td>Flag to specify whether or not the confirmation message is sent. Requires app scope JWT.</td>
</tr>
</tbody></table>

<p>Linking allows users to continue conversations on their preferred channels. An appUser&rsquo;s linked channels will be found in the <code class="prettyprint">clients</code> field.</p>

<p>When a link request is first made, the channel will be added to the <code class="prettyprint">pendingClients</code> field. The appUser is then prompted to accept the linking request. If they do so, the corresponding channel is then moved from the <code class="prettyprint">pendingClients</code> field to <code class="prettyprint">clients</code> field. If they reject the linking request then the channel is removed from <code class="prettyprint">pendingClients</code>.</p>

<p>It is possible to skip the confirmation step with the <code class="prettyprint">skipConfirmation</code> flag. App scope JWT is required to specify the confirmation option.</p>
<h3 id='linkable-channels-and-entities'>Linkable channels and entities</h3>
<p>Given that there is no way for you to provide Smooch with the necessary ID to connect Messenger, LINE, WeChat or Telegram, we have limited the API to only accept Twilio for now.
Support for Frontend Email is coming soon.</p>

<table><thead>
<tr>
<th>Channel type</th>
<th>Required entity</th>
</tr>
</thead><tbody>
<tr>
<td>twilio</td>
<td><strong>phoneNumber</strong><br/> A String of the appUser&rsquo;s phone number. It must contain the <code class="prettyprint">+</code> prefix and the country code.<br/> Examples of valid phone numbers: <code class="prettyprint">+1 212-555-2368</code>, <code class="prettyprint">+12125552368</code>, <code class="prettyprint">+1 212 555 2368</code>.<br/> Examples of invalid phone numbers: <code class="prettyprint">212 555 2368</code>, <code class="prettyprint">1 212 555 2368</code>.</td>
</tr>
</tbody></table>
<h2 id='unlink-app-user-from-channel'>Unlink App User From Channel</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/deb920657bbc3adc3fec7963/channels/twilio <span class="se">\</span>
     -X DELETE <span class="se">\</span>
     -d <span class="s1">'{"type": "twilio"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">unlinkChannel</span><span class="p">(</span><span class="s1">'steveb@channel5.com'</span><span class="p">,</span> <span class="s1">'twilio'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>

<p><api><code class="prettyprint">DELETE /v1/appusers/{smoochId|userId}/channels/{channel}</code></api></p>

<p>Removes the specified channel from the appUser&rsquo;s clients.</p>
<h1 id='conversations'>Conversations</h1>
<p>When the first message is sent to an app user or received from an app user, a conversation is automatically created for them. The conversation and messages for a given app user can be retrieved and created by way of the <code class="prettyprint">/v1/appusers/</code> API.</p>
<h2 id='get-messages'>Get Messages</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appUsers/c7f6e6d6c3a637261bd9656f/messages?before<span class="o">=</span>1471995721 <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">getMessages</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span><span class="na">before</span><span class="p">:</span> <span class="s1">'1471995721'</span><span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"conversation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"df0ebe56cbeab98589b8bfa7"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"unreadCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8c1498590aa1900b9b9b1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"authorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c7f6e6d6c3a637261bd9656f"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appUser"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Just put some vinegar on it"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"avatarUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.gravatar.com/image.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="mf">1439220041.586</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"next"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages?after=1471995721"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/appusers/{smoochId|userId}/messages</code></api></p>

<p>Get the specified app user&rsquo;s conversation history with a limit of 100 messages, if it exists. If a conversation has not yet been created for the specified app user, 404 will be returned.</p>
<h3 id='pagination'>Pagination</h3>
<p>The API endpoint for retrieving messages of a conversation has a limit of a 100 messages. The <code class="prettyprint">before</code> and <code class="prettyprint">after</code> parameters will have to be specified to indicate which range of messages to return. These parameters are mutually exclusive. If neither is specified, then the most recent 100 messages will be returned.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">before</code></td>
<td>Timestamp of message. The API will return 100 messages before the specified timestamp (excluding any messages with the provided timestamp).</td>
</tr>
<tr>
<td><code class="prettyprint">after</code></td>
<td>Timestamp of message. The API will return 100 messages after the specified timestamp (excluding any messages with the provided timestamp).</td>
</tr>
</tbody></table>

<p><aside class="notice">
The timestamp format should be in seconds using <a href="https://en.wikipedia.org/wiki/Unix_time">Unix time</a>. Note that you can specify milliseconds using a decimal number if needed.
</aside></p>
<h2 id='reset-unread-count'>Reset Unread Count</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/conversation/read <span class="se">\</span>
     -X POST <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">conversations</span><span class="p">.</span><span class="nx">resetUnreadCount</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>

<p><api><code class="prettyprint">POST /v1/appusers/{appUserId|userId}/conversation/read</code></api></p>

<p>Reset the unread count of the conversation to 0. If the conversation has not yet been created for the specified app user 404 will be returned.</p>
<h2 id='typing-activity'>Typing Activity</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/conversation/activity <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"role":"appMaker", "type": "typing:start"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// This endpoint is not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"conversation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"df0ebe56cbeab98589b8bfa7"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"unreadCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/appusers/{appUserId|userId}/conversation/activity</code></api></p>

<p>Notify Smooch when an app maker starts or stops typing a response.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>role</strong><br/><span class='req'>required</span></td>
<td>The role of the actor. Must be <code class="prettyprint">appMaker</code>.</td>
</tr>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The type of activity to trigger. Must be either <code class="prettyprint">typing:start</code> or <code class="prettyprint">typing:stop</code></td>
</tr>
<tr>
<td><strong>name</strong><br/><span class='opt'>optional</span></td>
<td>The name of the app maker that starts or stops typing a response</td>
</tr>
<tr>
<td><strong>avatarUrl</strong><br/><span class='opt'>optional</span></td>
<td>The avatar URL of the app maker that starts typing a response</td>
</tr>
</tbody></table>

<p><aside class="notice">
Typing activity is only supported on our Web Messenger, iOS SDK, Facebook Messenger and Telegram
</aside></p>
<h2 id='post-message'>Post Message</h2>
<blockquote>
<p>Request (App User):</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"text":"Just put some vinegar on it", "role": "appUser", "type": "text"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Just put some vinegar on it'</span><span class="p">,</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appUser'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'text'</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Request (App Maker):</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"text":"Just put some vinegar on it", "role": "appMaker", "type": "text"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Just put some vinegar on it'</span><span class="p">,</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8c1498590aa1900b9b9b1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"authorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c7f6e6d6c3a637261bd9656f"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appMaker"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Just put some vinegar on it"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"avatarUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.gravatar.com/image.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="mf">1439220041.586</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"conversation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"df0ebe56cbeab98589b8bfa7"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"unreadCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/appusers/{smoochId|userId}/messages</code></api></p>

<p>Post a message to or from the app user. If the app user does not yet have a conversation, one will be created automatically. Messages must have a <code class="prettyprint">role</code> of either <code class="prettyprint">appUser</code> or <code class="prettyprint">appMaker</code>.</p>

<p>A message must also have a <code class="prettyprint">type</code> specifying the type of message you&rsquo;re trying to send.
Depending on the type, the message object will have additional <code class="prettyprint">Required</code> and <code class="prettyprint">Optional</code> arguments.
See <a href="#text-message"><code class="prettyprint">text</code></a>, <a href="#image-message"><code class="prettyprint">image</code></a>, <a href="#carousel-message"><code class="prettyprint">carousel</code></a>, <a href="#list-message"><code class="prettyprint">list</code></a>.</p>

<p>Images can be posted by URL using this API via the <code class="prettyprint">image</code> type. Alternatively, you may also upload images to the conversation directly using the <a href="#upload-image"><code class="prettyprint">/images</code></a> endpoint.</p>

<p><aside class="notice">
For messages originating from an app maker, a <code class="prettyprint">jwt</code> credential with <code class="prettyprint">app</code> level scope must be used.
</aside></p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>role</strong><br/><span class='req'>required</span></td>
<td>The role of the individual posting the message. Can be either <code class="prettyprint">appUser</code> or <code class="prettyprint">appMaker</code>.</td>
</tr>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The type of the message being posted. Can be <a href="#text-message"><code class="prettyprint">text</code></a>, <a href="#image-message"><code class="prettyprint">image</code></a>, <a href="#carousel-message"><code class="prettyprint">carousel</code></a> or <a href="#list-message"><code class="prettyprint">list</code></a>.</td>
</tr>
<tr>
<td><strong>name</strong><br/><span class='opt'>optional</span></td>
<td>The display name of the message author. Messages with role <code class="prettyprint">appUser</code> will default to a friendly name based on the user&rsquo;s <code class="prettyprint">givenName</code> and <code class="prettyprint">surname</code>. Messages with role <code class="prettyprint">appMaker</code> have no default name.</td>
</tr>
<tr>
<td><strong>email</strong><br/><span class='opt'>optional</span></td>
<td>The email address of the message author. This field is typically used to identify an app maker in order to render the avatar in the app user client. If the email of the Smooch account is used, the configured profile avatar will be used. Otherwise, any <a href="http://gravatar.com">gravatar</a> matching the specified email will be used as the message avatar.</td>
</tr>
<tr>
<td><strong>avatarUrl</strong><br/><span class='opt'>optional</span></td>
<td>The URL of the desired message avatar image. This field will override any avatar chosen via the <code class="prettyprint">email</code> parameter.</td>
</tr>
<tr>
<td><strong>metadata</strong><br/><span class='opt'>optional</span></td>
<td>Flat JSON object containing any custom properties associated with the message. If you are developing your own messaging client you can use this field to render custom message types.</td>
</tr>
<tr>
<td><strong>payload</strong><br/><span class='opt'>optional</span></td>
<td>The payload of a <code class="prettyprint">reply</code> action, if applicable</td>
</tr>
</tbody></table>

<p><aside class="notice">
Additional arguments are necessary based on message type (<a href="#text-message"><code class="prettyprint">text</code></a>, <a href="#image-message"><code class="prettyprint">image</code></a>, <a href="#carousel-message"><code class="prettyprint">carousel</code></a>, <a href="#list-message"><code class="prettyprint">list</code></a>)
</aside></p>
<h2 id='text-message'>Text Message</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span> <span class="se">\</span>
     -d <span class="s1">'
{
    "role": "appMaker",
    "type": "text",
    "text": "Hello!",
    "actions": [{
        "text": "More info",
        "type": "link",
        "uri": "http://example.org"
    }]
}'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Hello!'</span><span class="p">,</span>
    <span class="na">actions</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'More info'</span><span class="p">,</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'link'</span><span class="p">,</span>
        <span class="na">uri</span><span class="p">:</span> <span class="s1">'http://example.org'</span>
    <span class="p">}]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d21c19c9da00839a5e9"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appMaker"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d22c19c9da00839a5ec"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"More info"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.org"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight javascript"><code><span class="mi">201</span> <span class="nx">CREATED</span>
</code></pre>

<p>A <code class="prettyprint">text</code> type message is a message that is sent with text and/or actions.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>text</strong><br/><span class='req'>required*</span></td>
<td>The text content of the message. Optional only if <code class="prettyprint">actions</code> are provided.</td>
</tr>
<tr>
<td><strong>actions</strong><br/><span class='opt'>optional*</span></td>
<td>Array of <a href="#action-buttons">action buttons</a>.</td>
</tr>
</tbody></table>
<h2 id='image-message'>Image Message</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span> <span class="se">\</span>
     -d <span class="s1">'
{
    "role": "appMaker",
    "type": "image",
    "text": "Hello!",
    "mediaUrl": "http://example.org/image.jpg",
    "actions": [{
        "text": "More info",
        "type": "link",
        "uri": "http://example.org"
    }]
}'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'image'</span><span class="p">,</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Hello!'</span><span class="p">,</span>
    <span class="na">mediaUrl</span><span class="p">:</span> <span class="s1">'http://example.org/image.jpg'</span><span class="p">,</span>
    <span class="na">actions</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'More info'</span><span class="p">,</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'link'</span><span class="p">,</span>
        <span class="na">uri</span><span class="p">:</span> <span class="s1">'http://example.org'</span>
    <span class="p">}]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d21c19c9da00839a5e9"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appMaker"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"mediaUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.org/image.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"mediaType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d22c19c9da00839a5ec"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"More info"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.org"</span><span class="w">
    </span><span class="p">}]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight javascript"><code><span class="mi">201</span> <span class="nx">CREATED</span>
</code></pre>

<p>An <code class="prettyprint">image</code> type message is a message that is sent with an image, and, optionally, text and/or actions.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>text</strong><br/><span class='opt'>optional*</span></td>
<td>The text content of the message.</td>
</tr>
<tr>
<td><strong>actions</strong><br/><span class='opt'>optional*</span></td>
<td>Array of <a href="#action-buttons">action buttons</a>.</td>
</tr>
<tr>
<td><strong>mediaUrl</strong><br/><span class='req'>required*</span></td>
<td>The image URL used for the image message.</td>
</tr>
<tr>
<td><strong>mediaType</strong><br/><span class='opt'>optional</span></td>
<td>The media type is defined here, for example <code class="prettyprint">image/jpeg</code>. If <code class="prettyprint">mediaType</code> is not specified, the media type will be resolved with the <code class="prettyprint">mediaUrl</code>.</td>
</tr>
</tbody></table>
<h2 id='carousel-message'>Carousel Message</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span> <span class="se">\</span>
     -d <span class="s1">'
{
    "role": "appMaker",
    "type": "carousel",
    "items": [{
        "title": "Tacos",
        "description": "Description",
        "mediaUrl": "http://example.org/image.jpg",
        "actions": [{
            "text": "Select",
            "type": "postback",
            "payload": "TACOS"
        }, {
            "text": "More info",
            "type": "link",
            "uri": "http://example.org"
        }]
    }, {
        "title": "Ramen",
        "description": "Description",
        "mediaUrl": "http://example.org/image.jpg",
        "actions": [{
            "text": "Select",
            "type": "postback",
            "payload": "RAMEN"
        }, {
            "text": "More info",
            "type": "link",
            "uri": "http://example.org"
        }]
    }]
}'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'carousel'</span><span class="p">,</span>
    <span class="na">items</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'Tacos'</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="s1">'Description'</span><span class="p">,</span>
        <span class="na">mediaUrl</span><span class="p">:</span> <span class="s1">'http://example.org/image.jpg'</span><span class="p">,</span>
        <span class="na">actions</span><span class="p">:</span> <span class="p">[{</span>
            <span class="na">text</span><span class="p">:</span> <span class="s1">'Select'</span><span class="p">,</span>
            <span class="na">type</span><span class="p">:</span> <span class="s1">'postback'</span><span class="p">,</span>
            <span class="na">payload</span><span class="p">:</span> <span class="s1">'TACOS'</span>
        <span class="p">},</span> <span class="p">{</span>
            <span class="na">text</span><span class="p">:</span> <span class="s1">'More info'</span><span class="p">,</span>
            <span class="na">type</span><span class="p">:</span> <span class="s1">'link'</span><span class="p">,</span>
            <span class="na">uri</span><span class="p">:</span> <span class="s1">'http://example.org'</span>
        <span class="p">}]</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'Ramen'</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="s1">'Description'</span><span class="p">,</span>
        <span class="na">mediaUrl</span><span class="p">:</span> <span class="s1">'http://example.org/image.jpg'</span><span class="p">,</span>
        <span class="na">actions</span><span class="p">:</span> <span class="p">[{</span>
            <span class="na">text</span><span class="p">:</span> <span class="s1">'Select'</span><span class="p">,</span>
            <span class="na">type</span><span class="p">:</span> <span class="s1">'postback'</span><span class="p">,</span>
            <span class="na">payload</span><span class="p">:</span> <span class="s1">'RAMEN'</span>
        <span class="p">},</span> <span class="p">{</span>
            <span class="na">text</span><span class="p">:</span> <span class="s1">'More info'</span><span class="p">,</span>
            <span class="na">type</span><span class="p">:</span> <span class="s1">'link'</span><span class="p">,</span>
            <span class="na">uri</span><span class="p">:</span> <span class="s1">'http://example.org'</span>
        <span class="p">}]</span>
    <span class="p">}]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d21c19c9da00839a5e9"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appMaker"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"carousel"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d21c19c9da00839a5ea"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tacos"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Description"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mediaUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.org/image.jpg"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mediaType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d22c19c9da00839a5eb"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Select"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TACOS"</span><span class="w">
        </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d22c19c9da00839a5ec"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"More info"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.org"</span><span class="w">
        </span><span class="p">}]</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d22c19c9da00839a5ed"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ramen"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Description"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mediaUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.org/image.jpg"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mediaType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d31c19c9da00839a5ee"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Select"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RAMEN"</span><span class="w">
        </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57966d31c19c9da00839a5ef"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"More info"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.org"</span><span class="w">
        </span><span class="p">}]</span><span class="w">
    </span><span class="p">}]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight javascript"><code><span class="mi">201</span> <span class="nx">CREATED</span>
</code></pre>

<p>Carousel messages are a horizontally scrollable set of items that may each contain text, an image, and action buttons. Not all messaging channels fully support carousel messages; currently only Facebook Messenger, LINE and Telegram cover the full functionality. For all other platforms a carousel message is rendered as raw text. The raw text fallback does not include any images or postback action buttons.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>items</strong><br/><span class='req'>required*</span></td>
<td>Array of <a href="#message-items">message items</a>. The array is limited to 10 items.</td>
</tr>
</tbody></table>
<h4 id='channel-support'>Channel Support</h4>
<p>Smooch will deliver carousel messages to users across all messaging channels regardless of whether or not a given channel can natively render a carousel message UI. For channels that don&rsquo;t render carousels, a raw text representation is sent. In the future, the Smooch API will expand to support new messaging app carousel experiences as they become available. For current messaging channels, carousel messages will render in the following ways:</p>
<h5 id='facebook-messenger'>Facebook Messenger</h5>
<p>Full support.
<img alt="messenger carousel" src="../images/carousel_messenger.png" /></p>
<h5 id='telegram'>Telegram</h5>
<p>Full support, with cards arranged vertically.
<img alt="telegram carousel" src="../images/carousel_telegram.png" /></p>
<h5 id='line'>LINE</h5>
<p>Full support.
<span class="half-width-img"><img alt="line carousel" src="../images/carousel_line.png" /></span></p>
<h5 id='all-other-channels'>All Other Channels</h5>
<blockquote>
<p>Sample Raw Text Format:</p>
</blockquote>
<pre class="highlight plaintext"><code>1. Tacos
Description
More info http://example.org

2. Ramen
Description
More info http://example.org
</code></pre>

<p>Text fallback.
<img alt="text fallback" src="../images/carousel_ios.png" /></p>
<h2 id='list-message'>List Message</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span> <span class="se">\</span>
     -d <span class="s1">'
     {
        "role":"appMaker",
        "type":"list",
        "items":[
           {
              "title":"Tacos",
              "description":"Beef and cheese... Mhm...",
              "size": "large",
              "mediaUrl":"https://www.tacojohns.com/globalassets/2016-tacos-menu/taco-bravo---436x420.jpg",
              "actions":[
                 {
                    "text":"Oh yeah!",
                    "type":"postback",
                    "payload":"TACOS"
                 }
              ]
           },
           {
              "title":"Burritos",
              "description":"Beefier and cheesier... Mhm...",
              "mediaUrl":"http://www.tacobueno.com/media/1381/beefbob.png?quality=65",
              "actions":[
                 {
                    "text":"Burritooo!",
                    "type":"postback",
                    "payload":"BURRITOS"
                 },
                 {
                    "text":"Burritooo!",
                    "type":"link",
                    "uri":"http://burritos.com",
                    "default": true
                 }
              ]
           }
        ],
        "actions":[
           {
              "text":"More Choices!",
              "type":"postback",
              "payload":"MORE"
           }
        ]
     }'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
   <span class="na">role</span><span class="p">:</span><span class="s2">"appMaker"</span><span class="p">,</span>
   <span class="na">type</span><span class="p">:</span><span class="s2">"list"</span><span class="p">,</span>
   <span class="na">items</span><span class="p">:[</span>
      <span class="p">{</span>
         <span class="na">title</span><span class="p">:</span><span class="s2">"Tacos"</span><span class="p">,</span>
         <span class="na">description</span><span class="p">:</span><span class="s2">"Beef and cheese... Mhm..."</span><span class="p">,</span>
         <span class="na">size</span><span class="p">:</span> <span class="s2">"large"</span><span class="p">,</span>
         <span class="na">mediaUrl</span><span class="p">:</span><span class="s2">"https://www.tacojohns.com/globalassets/2016-tacos-menu/taco-bravo---436x420.jpg"</span><span class="p">,</span>
         <span class="na">actions</span><span class="p">:[</span>
            <span class="p">{</span>
               <span class="na">text</span><span class="p">:</span><span class="s2">"Oh yeah!"</span><span class="p">,</span>
               <span class="na">type</span><span class="p">:</span><span class="s2">"postback"</span><span class="p">,</span>
               <span class="na">payload</span><span class="p">:</span><span class="s2">"TACOS"</span>
            <span class="p">}</span>
         <span class="p">]</span>
      <span class="p">},</span>
      <span class="p">{</span>
         <span class="na">title</span><span class="p">:</span><span class="s2">"Burritos"</span><span class="p">,</span>
         <span class="na">description</span><span class="p">:</span><span class="s2">"Beefier and cheesier... Mhm..."</span><span class="p">,</span>
         <span class="na">mediaUrl</span><span class="p">:</span><span class="s2">"http://www.tacobueno.com/media/1381/beefbob.png?quality=65"</span><span class="p">,</span>
         <span class="na">actions</span><span class="p">:[</span>
            <span class="p">{</span>
               <span class="na">text</span><span class="p">:</span><span class="s2">"Burritooo!"</span><span class="p">,</span>
               <span class="na">type</span><span class="p">:</span><span class="s2">"postback"</span><span class="p">,</span>
               <span class="na">payload</span><span class="p">:</span><span class="s2">"BURRITOS"</span>
            <span class="p">},</span>
            <span class="p">{</span>
               <span class="na">text</span><span class="p">:</span><span class="s2">"Burritooo!"</span><span class="p">,</span>
               <span class="na">type</span><span class="p">:</span><span class="s2">"link"</span><span class="p">,</span>
               <span class="na">uri</span><span class="p">:</span><span class="s2">"http://burritos.com"</span><span class="p">,</span>
               <span class="na">default</span><span class="p">:</span> <span class="kc">true</span>
            <span class="p">}</span>
         <span class="p">]</span>
      <span class="p">}</span>
   <span class="p">],</span>
   <span class="na">actions</span><span class="p">:[</span>
      <span class="p">{</span>
         <span class="na">text</span><span class="p">:</span><span class="s2">"More Choices!"</span><span class="p">,</span>
         <span class="na">type</span><span class="p">:</span><span class="s2">"postback"</span><span class="p">,</span>
         <span class="na">payload</span><span class="p">:</span><span class="s2">"MORE"</span>
      <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appMaker"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="mf">1480021430.242</span><span class="p">,</span><span class="w">
    </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1. Tacos\nBeef and cheese... Mhm...\n\n\n2. Burritos\nBeefier and cheesier... Mhm...\nBurritooo!: http://burritos.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"authorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7AJ4zpAVxEwKkjCZD2EYKk"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"avatarUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.gravatar.com/avatar/5e543256c480ac577d30f76f9120eb74.png?s=200&amp;d=mm"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"583755b6be483684d148602b"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"api"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tacos"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Beef and cheese... Mhm..."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mediaUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.tacojohns.com/globalassets/2016-tacos-menu/taco-bravo---436x420.jpg"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mediaType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"583755b6be483684d1486033"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Oh yeah!"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TACOS"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"583755b6be483684d1486034"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Burritos"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Beefier and cheesier... Mhm..."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mediaUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.tacobueno.com/media/1381/beefbob.png?quality=65"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mediaType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/png"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"583755b6be483684d1486030"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Burritooo!"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BURRITOS"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"583755b6be483684d1486032"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Burritooo!"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"583755b6be483684d1486031"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://burritos.com"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"More Choices!"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MORE"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"583755b6be483684d1486035"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"conversation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"unreadCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"94eb1cd68c3e072a5ea0e242"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight javascript"><code><span class="mi">201</span> <span class="nx">CREATED</span>
</code></pre>

<p>List messages are a vertically scrollable set of items that may each contain text, an image, and action buttons. Not all messaging channels fully support list messages; currently only Facebook Messenger has support. LINE and Telegram have a carousel fallback, and for all other platforms a list message is rendered as raw text. The raw text fallback does not include any images or postback action buttons.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>items</strong><br/><span class='req'>required*</span></td>
<td>Array of <a href="#message-items">message items</a>. The array is limited to 10 items.</td>
</tr>
<tr>
<td><strong>actions</strong><br/><span class='opt'>optional*</span></td>
<td>Array of <a href="#action-buttons">action buttons</a>.</td>
</tr>
</tbody></table>

<p><aside class="notice">
    In Messenger, list messages sent with multiple <code class="prettyprint">actions</code> either in a <code class="prettyprint">message item</code> or the <code class="prettyprint">message</code> itself will be truncated, as only 1 action is supported.
</aside></p>

<p><span class="half-width-img"><img alt="messenger list" src="../images/list_messenger.png" /></span></p>
<h2 id='message-items'>Message Items</h2>
<p>Message items can be sent through the <a href="#post-message">post message API</a> by including them in the message payload.</p>

<p>Only <a href="#carousel-message">carousel</a> and <a href="#list-message">list</a> messages currently support message items.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>title</strong><br/><span class='req'>required</span></td>
<td>The title of the carousel item.</td>
</tr>
<tr>
<td><strong>actions</strong><br/><span class='req'>required</span></td>
<td>Array of <a href="#action-buttons">action buttons</a>. At least 1 is required, a maximum of 3 are allowed. <code class="prettyprint">link</code> and <code class="prettyprint">postback</code> and <code class="prettyprint">share</code> actions are supported.</td>
</tr>
<tr>
<td><strong>description</strong><br/><span class='opt'>optional</span></td>
<td>The text description, or subtitle.</td>
</tr>
<tr>
<td><strong>mediaUrl</strong><br/><span class='opt'>optional</span></td>
<td>The image URL to be shown in the carousel/list item.</td>
</tr>
<tr>
<td><strong>size</strong><br/><span class='opt'>optional</span></td>
<td>The size of the image to be shown in the carousel/list item (Only top item of Facebook Messenger carousel supportted). Choose from <code class="prettyprint">compact</code> and <code class="prettyprint">large</code></td>
</tr>
<tr>
<td><strong>mediaType</strong><br/><span class='opt'>optional</span></td>
<td>If a <code class="prettyprint">mediaUrl</code> was specified, the media type is defined here, for example <code class="prettyprint">image/jpeg</code>. If <code class="prettyprint">mediaType</code> is not specified, the media type will be resolved with the <code class="prettyprint">mediaUrl</code>.</td>
</tr>
</tbody></table>
<h2 id='action-buttons'>Action Buttons</h2>
<p>Actions buttons can be sent through the <a href="#post-message">post message API</a> by including them in the message payload.</p>

<p>There are 4 types of supported actions : <strong>link</strong>, <strong>buy</strong>, <strong>postback</strong>, and <strong>reply</strong>. Type must be specified by providing a <code class="prettyprint">type</code> argument in the action object.</p>

<p><aside class="notice">
    Action buttons can only be sent with an <code class="prettyprint">appMaker</code> role.
</aside></p>

<blockquote>
<p>Send link action:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"text":"Just put some vinegar on it", "role": "appMaker", "type": "text", "actions": [{"type": "link", "text": "Put vinegar", "uri": "http://example.com" }]}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Just put some vinegar on it'</span><span class="p">,</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
    <span class="na">actions</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'link'</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'Put vinegar'</span><span class="p">,</span>
        <span class="na">uri</span><span class="p">:</span> <span class="s1">'http://example.com'</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<table><thead>
<tr>
<th><strong>Link</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>text</strong><br/><span class='req'>required</span></td>
<td>The button text.</td>
</tr>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td><code class="prettyprint">link</code></td>
</tr>
<tr>
<td><strong>uri</strong><br/><span class='req'>required</span></td>
<td>The action URI. This is the link that will be used in the clients when clicking the button.</td>
</tr>
<tr>
<td><strong>default</strong><br/><span class='opt'>optional</span></td>
<td>Flag indicating the message action is the default for a <a href="#message-items">message item</a> in Facebook Messenger.</td>
</tr>
<tr>
<td><strong>metadata</strong><br/><span class='opt'>optional</span></td>
<td>Flat JSON object containing any custom properties associated with the action.</td>
</tr>
</tbody></table>

<p><aside class="notice">
    Action buttons sent to LINE must have <code class="prettyprint">http</code> or <code class="prettyprint">https</code> protocol or the message will not be delivered.
</aside></p>

<blockquote>
<p>Send buy action:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"text":"Just put some vinegar on it", "role": "appMaker", "type": "text", "actions": [{"type": "buy", "text": "Buy vinegar", "amount": 1000 }]}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Just put some vinegar on it'</span><span class="p">,</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
    <span class="na">actions</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'buy'</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'Buy vinegar'</span><span class="p">,</span>
        <span class="na">amount</span><span class="p">:</span> <span class="mi">8000</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<table><thead>
<tr>
<th><strong>Buy</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>text</strong><br/><span class='req'>required</span></td>
<td>The button text.</td>
</tr>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td><code class="prettyprint">buy</code></td>
</tr>
<tr>
<td><strong>amount</strong><br/><span class='req'>required</span></td>
<td>The amount being charged. It needs to be specified in cents and is an integer (9.99$ -&gt; 999).</td>
</tr>
<tr>
<td><strong>currency</strong><br/><span class='opt'>optional</span></td>
<td>The currency of the amount being charged (USD, CAD, etc.). If not specified, it would use the default one set in your account. <a href="https://support.stripe.com/questions/which-currencies-does-stripe-support">See supported currencies</a>.</td>
</tr>
<tr>
<td><strong>metadata</strong><br/><span class='opt'>optional</span></td>
<td>Flat JSON object containing any custom properties associated with the action.</td>
</tr>
</tbody></table>

<p><aside class="notice">
The <a href="/javascript/#stripe">Stripe integration</a> must be configured and active in order to accept buy buttons.
</aside></p>

<blockquote>
<p>Send postback action:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"text":"Just put some vinegar on it", "role": "appMaker", "type": "text", "actions": [{"type": "postback", "text": "Send vinegar", "payload": "buy_vinegar" }]}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Just put some vinegar on it'</span><span class="p">,</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
    <span class="na">actions</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'postback'</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'Buy vinegar'</span><span class="p">,</span>
        <span class="na">payload</span><span class="p">:</span> <span class="s1">'buy_vinegar'</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<table><thead>
<tr>
<th><strong>Postback</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>text</strong><br/><span class='req'>required</span></td>
<td>The button text.</td>
</tr>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td><code class="prettyprint">postback</code></td>
</tr>
<tr>
<td><strong>payload</strong><br/><span class='req'>required</span></td>
<td>A string payload to help you identify the action context. You can also use metadata for more complex needs.</td>
</tr>
<tr>
<td><strong>metadata</strong><br/><span class='opt'>optional</span></td>
<td>Flat JSON object containing any custom properties associated with the action.</td>
</tr>
</tbody></table>

<p><aside class="notice">
See how to handle postback with <a href="#webhook-triggers">webhook triggers</a>.
</aside></p>

<blockquote>
<p>Send reply action:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
     -d <span class="s1">'
{
    "text":"Which do you prefer?",
    "role": "appMaker",
    "type": "text",
    "actions": [{
        "type": "reply",
        "text": "Tacos",
        "payload": "TACOS"
    }, {
        "type": "reply",
        "text": "Burritos",
        "payload": "BURRITOS"
    }]
}'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Which do you prefer?'</span><span class="p">,</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
    <span class="na">actions</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'reply'</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'Tacos'</span><span class="p">,</span>
        <span class="na">payload</span><span class="p">:</span> <span class="s1">'TACOS'</span>
      <span class="p">},</span> <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'reply'</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'Burritos'</span><span class="p">,</span>
        <span class="na">payload</span><span class="p">:</span> <span class="s1">'BURRITOS'</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<table><thead>
<tr>
<th><strong>Reply</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>text</strong><br/><span class='req'>required</span></td>
<td>The button text.</td>
</tr>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td><code class="prettyprint">reply</code></td>
</tr>
<tr>
<td><strong>payload</strong><br/><span class='req'>required</span></td>
<td>A string payload to help you identify the action context. Used when posting the reply. You can also use metadata for more complex needs.</td>
</tr>
<tr>
<td><strong>iconUrl</strong><br/><span class='opt'>optional</span></td>
<td>An icon to render next to the reply option (Facebook Messenger and Web Messenger only)</td>
</tr>
<tr>
<td><strong>metadata</strong><br/><span class='opt'>optional</span></td>
<td>Flat JSON object containing any custom properties associated with the action.</td>
</tr>
</tbody></table>

<p><aside class="notice">
<code class="prettyprint">reply</code> type actions are mutually exclusive with other action types. When specifying a <code class="prettyprint">reply</code> action, all other actions on the same message must also be of type <code class="prettyprint">reply</code>, otherwise the message will be considered invalid.
</aside></p>
<h3 id='reply-actions-with-icon'>Reply Actions with icon</h3>
<blockquote>
<p>Send reply actions with icon URLs:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
     -d <span class="s1">'
{
    "text":"Which do you prefer?",
    "role": "appMaker",
    "actions": [{
        "type": "reply",
        "text": "Tacos",
        "iconUrl": "http://example.org/taco.png"
        "payload": "TACOS"
    }, {
        "type": "reply",
        "text": "Burritos",
        "iconUrl": "http://example.org/burrito.png"
        "payload": "BURRITOS"
    }]
}'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Which do you prefer?'</span><span class="p">,</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span><span class="p">,</span>
    <span class="na">actions</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'reply'</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'Tacos'</span><span class="p">,</span>
        <span class="na">iconUrl</span><span class="p">:</span> <span class="s1">'http://example.org/taco.png'</span><span class="p">,</span>
        <span class="na">payload</span><span class="p">:</span> <span class="s1">'TACOS'</span>
      <span class="p">},</span> <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'reply'</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'Burritos'</span><span class="p">,</span>
        <span class="na">iconUrl</span><span class="p">:</span> <span class="s1">'http://example.org/burrito.png'</span><span class="p">,</span>
        <span class="na">payload</span><span class="p">:</span> <span class="s1">'BURRITOS'</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<p>For <code class="prettyprint">reply</code> actions you may optionally specify an <code class="prettyprint">iconUrl</code> which will render as an icon for each option.</p>

<p><aside class="notice">
Icons are currrently only supported on Facebook Messenger and Web Messenger.
</aside></p>

<p><strong>Facebook Messenger</strong>
<img alt="Facebook Messenger reply icons" src="../images/fb_reply_icon.png" /></p>

<p><strong>Web Messenger</strong>
<img alt="Web Messenger reply icons" src="../images/web_reply_icon.png" /></p>
<h3 id='share-actions'>Share Actions</h3>
<blockquote>
<p>Send share action:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/messages <span class="se">\</span>
     -X POST <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s2">"authorization: Bearer your-jwt"</span> <span class="se">\</span>
     -d <span class="s1">'
{
    "role": "appMaker",
    "type": "carousel",
    "items": [{
        "title": "Title",
        "description": "Description",
        "mediaUrl": "http://example.org/image.jpg",
        "mediaType": "image/jpeg",
        "actions": [{
            "type": "share"
        }]
    }]
}'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Title'</span><span class="p">,</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appMaker'</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'carousel'</span><span class="p">,</span>
    <span class="na">items</span><span class="p">:</span> <span class="p">[{</span>
      <span class="na">title</span><span class="p">:</span> <span class="s1">'Title'</span><span class="p">,</span>
      <span class="na">actions</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'share'</span>
      <span class="p">}]</span>
    <span class="p">}]</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<p>Actions in a <a href="#message-items">message item</a> may also include a share button.
Currently, this feature is only supported in Facebook Messenger. For more information, see the Facebook Messenger platform <a href="https://developers.facebook.com/docs/messenger-platform/send-api-reference/share-button">documentation</a>.</p>

<p><img alt="messenger carousel" src="../images/facebook_share_button.png" /></p>

<table><thead>
<tr>
<th><strong>Share</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td><code class="prettyprint">share</code></td>
</tr>
<tr>
<td><strong>metadata</strong><br/><span class='opt'>optional</span></td>
<td>Flat JSON object containing any custom properties associated with the action.</td>
</tr>
</tbody></table>

<p><aside class="notice">
Share Buttons are currently only supported in Facebook Messenger carousels.
</aside></p>
<h2 id='upload-image'>Upload Image</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/appusers/c7f6e6d6c3a637261bd9656f/images <span class="se">\</span>
     -X POST <span class="se">\</span>
     -H <span class="s1">'app-token: cr2g6jgxrahuh68n1o3e2fcnt'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: multipart/form-data'</span> <span class="se">\</span>
     -F <span class="s1">'source=@screenshot.jpg;type=image/jpeg'</span> <span class="se">\</span>
     -F <span class="s1">'role=appUser'</span> <span class="se">\</span>
     -F <span class="s1">'name=Steve'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// Frontend version</span>
<span class="kd">var</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">fileInput</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="nx">smooch</span><span class="p">.</span><span class="nx">appUsers</span><span class="p">.</span><span class="nx">uploadImage</span><span class="p">(</span><span class="s1">'c7f6e6d6c3a637261bd9656f'</span><span class="p">,</span> <span class="nx">file</span><span class="p">,</span>
<span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Just put some vinegar on it'</span><span class="p">,</span>
    <span class="na">role</span><span class="p">:</span> <span class="s1">'appUser'</span>

<span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>

<span class="c1">// Not yet supported on Node.</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8c1498590aa1900b9b9b1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"authorId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c7f6e6d6c3a637261bd9656f"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"appUser"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Steve"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://media.smooch.io/image.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"mediaUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://media.smooch.io/image.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"mediaType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"avatarUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.gravatar.com/image.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="mf">1446599350.851</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"conversation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"df0ebe56cbeab98589b8bfa7"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"unreadCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/appusers/{smoochId|userId}/images</code></api></p>

<p>Upload an image and post it to the conversation. Images are uploaded using the <code class="prettyprint">multipart/form-data</code> content type. Similar to the <code class="prettyprint">/messages</code> endpoint, a <code class="prettyprint">role</code> parameter must be specified. The <code class="prettyprint">/images</code> endpoint accepts the same parameters as <code class="prettyprint">/messages</code> but they are sent as form parameters as opposed to being encoded in JSON bodies. The uploaded image will render as part of the message thread in all supported app maker channels (email, Slack, HipChat, Zendesk, Helpscout).</p>

<table><thead>
<tr>
<th><strong>Form Parameters</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>source</strong><br/><span class='req'>required</span></td>
<td>The image data.</td>
</tr>
<tr>
<td><strong>role</strong><br/><span class='req'>required</span></td>
<td>The role of the individual posting the message. Can be either <code class="prettyprint">appUser</code> or <code class="prettyprint">appMaker</code>.</td>
</tr>
</tbody></table>
<h1 id='persistent-menus'>Persistent Menus</h1>
<p>Smooch provides a /v1/menu/ API to set persistent menus on messaging channels that support custom menus in their chat UIs (<a href="http://docs.smooch.io/javascript/#facebook-messenger">Facebook Messenger</a> and <a href="http://docs.smooch.io/javascript/#wechat">WeChat</a>). Menus are configured on a per app basis (not per user).</p>
<h2 id='get-menu'>Get Menu</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/menu <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">get</span><span class="p">()</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"menu"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Awesome Menu"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smooch"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://smooch.io"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57b331fbf1c6aeba1f940dc7"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postback"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"payload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HELLO"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57b331fbf1c6aeba1f940dc6"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/menu</code></api></p>

<p>Get the specified app&rsquo;s menu.</p>
<h2 id='update-menu'>Update Menu</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/menu <span class="se">\</span>
     -X PUT <span class="se">\</span>
     -d <span class="s1">'{"items": [{"type": "link", "text": "Smooch", "uri": "http://smooch.io"}]}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'My Awesome Menu'</span><span class="p">,</span>
    <span class="na">items</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">type</span><span class="p">:</span> <span class="s1">'link'</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="s1">'Smooch'</span><span class="p">,</span>
        <span class="na">uri</span><span class="p">:</span> <span class="s1">'http://smooch.io'</span>
    <span class="p">}]</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"menu"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Awesome Menu"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smooch"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://smooch.io"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"57b331fbf1c6aeba1f940dc7"</span><span class="w">
        </span><span class="p">}]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">PUT /v1/menu</code></api></p>

<p>Configure the specified app&rsquo;s menu.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>items</strong><br/><span class='req'>required</span></td>
<td>A list of menu items. See below.</td>
</tr>
<tr>
<td><strong>name</strong><br/><span class='opt'>optional</span></td>
<td>An optional text to use as a menu name. If none is provided defaults to &ldquo;Menu&rdquo;. Not all channels support a custom menu name (e.g. Facebook Messenger&rsquo;s menu name is fixed)</td>
</tr>
</tbody></table>
<h3 id='menu-items'>Menu Items</h3>
<p>Menus contain 1 to 5 menu items.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>Can either be <a href="/javascript/#links">link</a> or <a href="/javascript/#postbacks">postback</a>, which correspond to Smooch&rsquo;s <a href="/javascript/#action-buttons">link and postback actions</a></td>
</tr>
<tr>
<td><strong>text</strong><br/><span class='opt'>required</span></td>
<td>The button text of the menu item.</td>
</tr>
<tr>
<td><strong>uri</strong><br/><span class='opt'>optional</span></td>
<td>A valid address, like http://smooch.io. Required for a &ldquo;link&rdquo; type item.</td>
</tr>
<tr>
<td><strong>postback</strong><br/><span class='opt'>optional</span></td>
<td>A payload for a postback. Required for a &ldquo;postback&rdquo; type item.</td>
</tr>
</tbody></table>
<h2 id='delete-menu'>Delete Menu</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/menu <span class="se">\</span>
     -X DELETE <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-jwt'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="nx">smooch</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// async code</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"menu"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">DELETE /v1/menu</code></api></p>

<p>Remove the specified app&rsquo;s menu.</p>

              <h1 class="section-header" id="managed-accounts">
                  Managed accounts
              </h1>
              <h1 id='introduction'>Introduction</h1>
<p>If you&rsquo;re looking to enable messaging inside your product for your customers, with as much control over the experience as youd like, you can create and control Smooch apps programmatically using Managed Accounts.</p>
<h1 id='authentication'>Authentication</h1>
<p>Managed Accounts require a <code class="prettyprint">account</code> scoped JWT. To sign those JWTs, you will need to use an Account level secret key. You can create one by going into your <a href="https://app.smooch.io/account">account page</a>. For more details about signing JWTs, see <a href="#jwt">this</a> section.</p>
<h3 id='using-the-account-scoped-token'>Using the Account Scoped Token</h3>
<p>Use the <code class="prettyprint">account</code> scoped JWT in the same way that you would use an <code class="prettyprint">app</code> or <code class="prettyprint">appUser</code> scoped JWT, by passing it as an Authorization header, with the token prefaced by the <em>Bearer</em> keyword. See <a href="#authentication">Authentication</a> for more details.</p>

<p>All of the existing core APIs such as <code class="prettyprint">/v1/appusers</code> and <code class="prettyprint">/v1/webhooks</code> are accessible using an <code class="prettyprint">account</code> JWT, provided the <code class="prettyprint">appId</code> is included in the the path (e.g. <code class="prettyprint">/v1/appusers</code> becomes <code class="prettyprint">/v1/apps/{appId}/appusers</code>)</p>
<h1 id='apps'>Apps</h1>
<p>Endpoints used for provisioning Smooch apps.</p>
<h2 id='create-app'>Create App</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"name": "My App"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8d9758590aa1900b9b9f6"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"appToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3s58wwlgx8xqbidgyyvzunoyw"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My App"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/apps</code></api></p>

<p>Creates a new app. The response body will include the appToken, which can be used to initialize the Web, iOS and Android clients and make calls to the app user facing API.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>name</strong><br/><span class='req'>required</span></td>
<td>The User facing name of the app.</td>
</tr>
</tbody></table>
<h2 id='list-apps'>List Apps</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/apps <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"apps"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8d9758590aa1900b9b9f6"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"appToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3s58wwlgx8xqbidgyyvzunoyw"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My App"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"hasMore"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/apps</code></api></p>

<p>Lists all apps configured. This API is paginated. It returns a max of 25 apps by default, and accepts offset and limit query parameters. The max limit is 100.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">limit</code></td>
<td>Integer, the number of records to return (maximum 100, default 25).</td>
</tr>
<tr>
<td><code class="prettyprint">offset</code></td>
<td>Integer, the number of initial records to skip before picking records to return.</td>
</tr>
</tbody></table>
<h2 id='get-app'>Get App</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6 <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55c8d9758590aa1900b9b9f6"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"appToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3s58wwlgx8xqbidgyyvzunoyw"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My App"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/apps/{appId}</code></api></p>

<p>Fetches an individual app.</p>
<h2 id='delete-app'>Delete App</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6 <span class="se">\</span>
       -X DELETE <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">DELETE /v1/apps/{appId}</code></api></p>

<p>Removes the specified app, including all its enabled integrations.</p>
<h1 id='app-keys'>App Keys</h1>
<p>This set of endpoints is used to provision and revoke secret keys for a Smooch app. A JWT with scope &lsquo;account&rsquo; is required to access the secret keys API.</p>
<h2 id='create-key'>Create Key</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/keys <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"name": "key1"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Y4SINFtAUzEjayxgUjJZoTjG"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app_5735dcf248011972d621dc01"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">POST /v1/apps/{appId}/keys</code></api></p>

<p>Creates a secret key for the specified app. The response body will include a secret as well it&rsquo;s corresponding id, which you can use to generate JSON Web Tokens to securely make API calls on behalf of the app.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>name</strong><br/><span class='req'>required</span></td>
<td>A friendly identifier for the secret key.</td>
</tr>
</tbody></table>
<h2 id='list-keys'>List keys</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/keys <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5XJ85yjUtRcaQu_pDINblPZb"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app_5723a347f82ba0516cb4ea34"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sTE74doRFsxtiwyT9JGCBQ6H"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app_5723a347f82ba0516cb4ea35"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/apps/{appId}/keys</code></api></p>

<p>Lists all secret keys for a given app.</p>
<h2 id='get-key'>Get Key</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/keys/app_5723a347f82ba0516cb4ea34 <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5XJ85yjUtRcaQu_pDINblPZb"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app_5723a347f82ba0516cb4ea34"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/apps/{appId}/keys/{keyId}</code></api></p>

<p>Returns a secret key.</p>
<h2 id='delete-key'>Delete Key</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/keys/app_5723a347f82ba0516cb4ea34 <span class="se">\</span>
       -X DELETE <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">DELETE /v1/apps/{appId}/keys/{keyId}</code></api></p>

<p>Removes a secret key.</p>
<h2 id='get-jwt'>Get JWT</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/keys/app_5723a347f82ba0516cb4ea34/jwt <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"jwt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJraWQiOiJhcHBfNTczNDE0NjQwN2E2OWI2MTAwNzQiLCJhbGciOiJIUzI1NiJ9.eyJzY29wZSI6ImFwcCJ9.aDkuZKRXzI3I3XRDtnqbrxIsQQuA7kMrV4r7KcwmeHc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">GET /v1/apps/{appId}/keys/{keyId}/jwt</code></api></p>

<p>Returns an app-scoped JWT signed using the requested keyId/secret pair.</p>
<h1 id='integrations'>Integrations</h1>
<p>This set of endpoints is used to configure and manage various front-end messaging channels. A JWT is required with <code class="prettyprint">account</code> scope. The paths below assume that the call will be made using an &lsquo;account&rsquo; scoped JWT.</p>

<p>The currently supported integration types are: Facebook Messenger, LINE, Telegram, Twilio SMS, WeChat, Viber and Email.</p>
<h2 id='create-integration'>Create Integration</h2>
<p><api><code class="prettyprint">POST /v1/apps/{appId}/integrations</code></api></p>

<p>The Create Integration endpoint currently allows you to provision apps with front-end messaging channels. See the sections below for channel specific instructions.</p>
<h2 id='facebook-messenger'>Facebook Messenger</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{ "type": "messenger", "pageAccessToken": "your_access_token", "appId": "your_fb_app_id", "appSecret": "your_fb_app_secret"
}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"integration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"582dedf230e788746891281a"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"messenger"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pageId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"841556169307254"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"appId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1674554616147204"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Facebook Messenger Setup steps:</p>

<ol>
<li>Take note of your Facebook app ID and secret (apps can be created at <a href="https://developer.facebook.com">developer.facebook.com</a>);</li>
<li>The Facebook app must have been submitted to Facebook for approval with the &ldquo;manage_pages&rdquo; and &ldquo;pages_messaging&rdquo; permissions.</li>
</ol>

<p>In order to integrate a Facebook Messenger app you must acquire a Page Access Token from your user. Once you have acquired a page access token from your user, call the Create Integration endpoint with your app secret and ID and the users page access token.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The integration type: <em>messenger</em>.</td>
</tr>
<tr>
<td><strong>pageAccessToken</strong><br/><span class='req'>required</span></td>
<td>A Facebook Page Access Token.</td>
</tr>
<tr>
<td><strong>appId</strong><br/><span class='req'>required</span></td>
<td>A Facebook App ID.</td>
</tr>
<tr>
<td><strong>appSecret</strong><br/><span class='req'>required</span></td>
<td>A Facebook App Secret.</td>
</tr>
</tbody></table>
<h2 id='twilio'>Twilio</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"type": "twilio", "accountSid": "ACa1b4c65ee0722712fab89867cb14eac7", "authToken": "160c024303f53049e1e060fd67ca6aefc", "phoneNumberSid": "PN0674df0ecee0c9819bca0ff0bc0a159e"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"integration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5735ddf948011972d621dc08"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"twilio"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phoneNumberSid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PN0674df0ecee0c9819bca0ff0bc0a159e"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phoneNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+15146125236"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mike's Account"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"accountSid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ACa1b4c65ee0722712fab89867cb14eac7"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>To configure a Twilio integration, acquire the required information from the user and call the Create Integration endpoint.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The integration type: <em>twilio</em>.</td>
</tr>
<tr>
<td><strong>accountSid</strong><br/><span class='req'>required</span></td>
<td>Twilio Account SID.</td>
</tr>
<tr>
<td><strong>authToken</strong><br/><span class='req'>required</span></td>
<td>Twilio Auth Token.</td>
</tr>
<tr>
<td><strong>phoneNumberSid</strong><br/><span class='req'>required</span></td>
<td>SID for specific phone number.</td>
</tr>
</tbody></table>
<h2 id='telegram'>Telegram</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"type": "telegram", "token": "192033615:AAEuee2FS2JYKWfDlTulfygjaIGJi4s"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"integration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5735ddfb48011972d621dc09"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"telegram"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mikes_smooch_bot"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>To configure a Telegram integration, acquire the required information from the user and call the Create Integration endpoint.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The integration type: <em>telegram</em>.</td>
</tr>
<tr>
<td><strong>token</strong><br/><span class='req'>required</span></td>
<td>Telegram Bot Token.</td>
</tr>
</tbody></table>
<h2 id='line'>LINE</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"type": "line", "channelAccessToken": "jZak8gGEYxfy1gIxk869osf2SuT6o11rtLqZQnAx9TiKE7eFXwgnnL58dtwOd1ON9e11GPTDfq+b4hson3dvvYAnAaAnbXYjj1rCUIzgxAa4xVZwGqyS+2rzpswZnGhAuMBWQxCMsF9dwztolUr01wdB04t89/1O/w1cDnyilFU=", "channelSecret": "b85cff984b26eac4297917abd365c4d6"'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"integration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5735ddfd48011972d621dc0a"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"line"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"botName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mike Bot"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>For LINE, each of your customers will need to manually configure a webhook in their LINE configuration page that will point to Smooch servers. You must instruct your customers how to configure this manually on their LINE bot page.</p>

<p>Your customers must set the Callback URL field in their <a href="https://business.line.me/en/">LINE Business Center page</a>.</p>

<p>The URL should look like the following: <code class="prettyprint">https://app.smooch.io:443/api/line/webhooks/{appId}</code>.</p>

<p>Once you&rsquo;ve acquired all the required information and the callback url has been configured, call the Create Integration endpoint.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The integration type: <em>line</em>.</td>
</tr>
<tr>
<td><strong>channelAccessToken</strong><br/><span class='req'>required</span></td>
<td>LINE Channel Access Token.</td>
</tr>
<tr>
<td><strong>channelSecret</strong><br/><span class='req'>required</span></td>
<td>LINE Channel Secret.</td>
</tr>
</tbody></table>
<h2 id='viber'>Viber</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"type": "viber", "token": "df5f8c5233399561-92636b0c5ba30da9-16d4928fc004a72d"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"integration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5818fa177682fcb51368635d"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"viber"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MikesBusiness"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>To configure a Viber integration, acquire the Viber Public Account token from the user and call the Create Integration endpoint.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The integration type: <em>viber</em>.</td>
</tr>
<tr>
<td><strong>token</strong><br/><span class='req'>required</span></td>
<td>Viber Public Account token.</td>
</tr>
</tbody></table>
<h2 id='wechat'>WeChat</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"type": "wechat", "appId": "ACa1b4c65ee0722712fab89867cb14eac7", "appSecret": "160c024303f53049e1e060fd67ca6aefc"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"integration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5735ddfd48011972d621dc0a"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wechat"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"appId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c69175d6d125b772b"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"webhookSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3889794ab2fd4a70940a97c4b4a6372e"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>To configure a WeChat integration, acquire the WeChat app ID and app secret from the customer and call the Create Integration endpoint.</p>

<p>In their <a href="https://mp.weixin.qq.com/">WeChat dashboard</a>, the customer must set the &ldquo;URL&rdquo; field to <code class="prettyprint">https://app.smooch.io/api/wechat/webhooks/{smoochAppId}</code>, and set the &ldquo;Token&rdquo; field to the value of the webhookSecret found in the response to the call to the Create Integration endpoint.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The integration type: <em>wechat</em>.</td>
</tr>
<tr>
<td><strong>appId</strong><br/><span class='req'>required</span></td>
<td>WeChat App ID.</td>
</tr>
<tr>
<td><strong>appSecret</strong><br/><span class='req'>required</span></td>
<td>WeChat App Secret.</td>
</tr>
<tr>
<td><strong>encodingAesKey</strong><br/><span class='opt'>optional</span></td>
<td>AES Encoding Key.</td>
</tr>
</tbody></table>
<h2 id='email'>Email</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations <span class="se">\</span>
     -X POST <span class="se">\</span>
     -d <span class="s1">'{"type": "frontendEmail"}'</span> <span class="se">\</span>
     -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
     -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>201 CREATED
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"integration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5735ddfd48011972d621dc0a"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"frontendEmail"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"shortId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tki1106"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"smoochAddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app.tki1106@mail.smooch.io"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>To configure an Email integration, simply call the Create Integration endpoint with the type argument <em>frontendEmail</em>.</p>

<table><thead>
<tr>
<th><strong>Arguments</strong></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong><br/><span class='req'>required</span></td>
<td>The integration type: <em>frontendEmail</em>.</td>
</tr>
<tr>
<td><strong>fromAddress</strong><br/><span class='opt'>optional</span></td>
<td>Email will display as coming from this address.</td>
</tr>
</tbody></table>
<h2 id='list-integrations'>List Integrations</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"integrations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"582dedf230e788746891281a"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"messenger"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pageId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"841556169307254"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"appId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1674554616147204"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5735ddf948011972d621dc08"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"twilio"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phoneNumberSid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PN0674df0ecee0c9819bca0ff0bc0a159e"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phoneNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+15146125236"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mike's Account"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"accountSid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ACa1b4c65ee0722712fab89867cb14eac7"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5735ddfb48011972d621dc09"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"telegram"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mikes_smooch_bot"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5735ddfd48011972d621dc0a"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"line"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"mid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uf0c0bc1813d372ac5af4c5b5faee9923"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"channelId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1462776483"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"botName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mike Bot"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p><api><code class="prettyprint">GET /v1/apps/{appId}/integrations</code></api></p>

<p>Lists all integrations for a given app.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">type</code></td>
<td>String, the list can be filtered to return only integrations of a specific type. Possible values are <em>messenger</em>, <em>line</em>, <em>telegram</em>, and <em>twilio</em>. More than one value can be specified through comma separation e.g. <code class="prettyprint">?types=twilio,line</code></td>
</tr>
</tbody></table>
<h2 id='get-integration'>Get Integration</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations/5735dded48011972d621dc02 <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"integration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"582dedf230e788746891281a"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"messenger"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pageId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"841556169307254"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"appId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1674554616147204"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p><api><code class="prettyprint">GET /v1/apps/{appId}/integrations/{integrationId}</code></api></p>

<p>Return the specified integration.</p>
<h2 id='delete-integration'>Delete Integration</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>  curl https://api.smooch.io/v1/apps/55c8d9758590aa1900b9b9f6/integrations/5735dded48011972d621dc02 <span class="se">\</span>
       -X DELETE <span class="se">\</span>
       -H <span class="s1">'authorization: Bearer your-account-token'</span>
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// These endpoints are not currently wrapped in a JavaScript lib</span>
</code></pre>

<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight plaintext"><code>200 OK
</code></pre>
<pre class="highlight json"><code><span class="p">{}</span><span class="w">
</span></code></pre>

<p><api><code class="prettyprint">DELETE /v1/apps/{appId}/integrations/{integrationId}</code></api></p>

<p>Removes the specified integration.</p>

              <h1 class="section-header" id="smooch-connect">
                  Smooch Connect
              </h1>
              <h1 id='introduction'>Introduction</h1>
<p>Smooch has a rapidly growing partner ecosystem which helps you unlock messaging in your product or service and lets customers find you alongside complementary partners. If you&rsquo;re interested in becoming a partner, tell us what you&rsquo;re building with Smooch using our <a href="https://smooch.io/partners/">partner application</a> and we&rsquo;ll provision you with everything you&rsquo;ll need to build your end of the OAuth flow using Smooch Connect. In the meantime the OAuth endpoints detailed below can be tested by impersonating Shoplifter, a partnership we built for testing purposes.</p>
<h1 id='add-to-smooch-button'>Add to Smooch Button</h1><pre class="highlight html"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://app.smooch.io/oauth/authorize?client_id=shoplifter&amp;response_type=code"</span><span class="nt">&gt;&lt;img</span> <span class="na">alt=</span><span class="s">"Add to Smooch"</span> <span class="na">height=</span><span class="s">"40"</span> <span class="na">width=</span><span class="s">"165"</span> <span class="na">src=</span><span class="s">"https://cdn.smooch.io/images/add_to_smooch.png"</span> <span class="na">srcset=</span><span class="s">"https://cdn.smooch.io/images/add_to_smooch.png 1x, https://cdn.smooch.io/images/add_to_smooch@2x.png 2x"</span><span class="nt">/&gt;&lt;/a&gt;</span>
</code></pre>

<p>This HTML template can be used to place an &ldquo;Add to Smooch&rdquo; button on your website.</p>

<p class="add-to-smooch-button">
    <a href="https://app.smooch.io/oauth/authorize?client_id=shoplifter&response_type=code"><img alt="Add to Smooch" height="40" width="165" src="https://cdn.smooch.io/images/add_to_smooch.png" srcset="https://cdn.smooch.io/images/add_to_smooch.png 1x, https://cdn.smooch.io/images/add_to_smooch@2x.png 2x"/></a>
</p>
<h1 id='sample-application'>Sample Application</h1>
<p>An open source sample application implementing Smooch Connect has been created to help demonstrate how to get it working. Give <a href="https://shoplifter.herokuapp.com/">Shoplifter</a> a try.</p>

<p>The source code is available <a href="https://github.com/smooch/shoplifter">here</a>.</p>
<h1 id='oauth-endpoints'>OAuth Endpoints</h1><h2 id='authorize'>Authorize</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl https://app.smooch.io/oauth/authorize?client_id<span class="o">=</span>shoplifter&amp;response_type<span class="o">=</span>code
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// This endpoint is not currently wrapped in a JavaScript lib</span>
</code></pre>

<p><api><code class="prettyprint">GET https://app.smooch.io/oauth/authorize</code></api></p>

<p>This endpoint begins the OAuth flow. It relies on a browser session for authentication. If the user is not logged in to Smooch they will be redirected to the login page. If the user has many apps, they will first be prompted to select the one they wish to integrate with. They will then be presented with an Allow/Deny dialog, describing details of the access your integration is requesting.</p>

<table><thead>
<tr>
<th><em>Parameter</em></th>
<th><em>Description</em></th>
</tr>
</thead><tbody>
<tr>
<td><strong>client_id</strong><br/><span class='req'>required</span></td>
<td>Your integration&rsquo;s unique identifier</td>
</tr>
<tr>
<td><strong>response_type</strong><br/><span class='req'>required</span></td>
<td>For now the only acceptable value is <code class="prettyprint">code</code></td>
</tr>
<tr>
<td><strong>state</strong><br/><span class='opt'>optional</span></td>
<td>You may pass in any arbitrary string value here which will be returned to you along with the code via browser redirect</td>
</tr>
<tr>
<td><strong>redirect_uri</strong><br/><span class='opt'>optional</span></td>
<td>You may pass in a redirect_uri to determine which URI the response is redirected to. This URI must be contained in the list configured by your integration. If this option is not passed, the first URI present in the list will be used</td>
</tr>
</tbody></table>
<h3 id='success-response'>Success Response</h3>
<p>A successful response is delivered via a 302 redirect to the redirect URI configured by your integration.</p>

<table><thead>
<tr>
<th><em>Parameter</em></th>
<th><em>Description</em></th>
</tr>
</thead><tbody>
<tr>
<td><strong>code</strong></td>
<td>An authorization code which can be exchanged for an access token</td>
</tr>
<tr>
<td><strong>state</strong></td>
<td>Your state parameter (if one was provided)</td>
</tr>
</tbody></table>
<h3 id='error-response'>Error Response</h3>
<table><thead>
<tr>
<th><em>Parameter</em></th>
<th><em>Description</em></th>
</tr>
</thead><tbody>
<tr>
<td><strong>error</strong></td>
<td>For example: <code class="prettyprint">access_denied</code></td>
</tr>
<tr>
<td><strong>state</strong></td>
<td>Your state parameter (if one was provided)</td>
</tr>
</tbody></table>
<h3 id='error-codes'>Error Codes</h3>
<table><thead>
<tr>
<th><em>Error Code</em></th>
<th><em>Delivery Method</em></th>
<th><em>Description</em></th>
</tr>
</thead><tbody>
<tr>
<td><strong>access_denied</strong></td>
<td>302</td>
<td>The user denied access</td>
</tr>
</tbody></table>
<h2 id='token'>Token</h2>
<blockquote>
<p>Request:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST https://api.smooch.io/oauth/token <span class="se">\</span>
     -d <span class="nv">code</span><span class="o">=</span>your_code <span class="se">\</span>
     -d <span class="nv">grant_type</span><span class="o">=</span>authorization_code <span class="se">\</span>
     -d <span class="nv">client_id</span><span class="o">=</span>shoplifter <span class="se">\</span>
     -d <span class="nv">client_secret</span><span class="o">=</span>secret
</code></pre>
<pre class="highlight javascript"><code><span class="c1">// This endpoint is not currently wrapped in a JavaScript lib</span>
</code></pre>

<p><api><code class="prettyprint">POST https://app.smooch.io/oauth/token</code></api></p>

<p>This endpoint is used to exchange an authorization code for an access token. It should only be used in server-to-server calls.</p>

<table><thead>
<tr>
<th><em>Parameter</em></th>
<th><em>Description</em></th>
</tr>
</thead><tbody>
<tr>
<td><strong>code</strong><br/><span class='req'>required</span></td>
<td>The authorization code received via <code class="prettyprint">/oauth/authorize</code></td>
</tr>
<tr>
<td><strong>grant_type</strong><br/><span class='req'>required</span></td>
<td>Must be set to <code class="prettyprint">authorization_code</code></td>
</tr>
<tr>
<td><strong>client_id</strong><br/><span class='req'>required</span></td>
<td>Your integration&rsquo;s unique identifier</td>
</tr>
<tr>
<td><strong>client_secret</strong><br/><span class='req'>required</span></td>
<td>Your integration&rsquo;s secret</td>
</tr>
</tbody></table>
<h3 id='success-response'>Success Response:</h3>
<table><thead>
<tr>
<th><em>Parameter</em></th>
<th><em>Description</em></th>
</tr>
</thead><tbody>
<tr>
<td><strong>access_token</strong></td>
<td>An access token that can now be used to call Smooch APIs</td>
</tr>
<tr>
<td><strong>token_type</strong></td>
<td><code class="prettyprint">Bearer</code>. All issued tokens are of this type</td>
</tr>
</tbody></table>
<h2 id='scope'>Scope</h2>
<p>The default scope of an issued access token is <code class="prettyprint">integration</code> scope. This allows API calls to be made to a specific Smooch app on behalf of an integration, identified by the integration&rsquo;s <code class="prettyprint">clientId</code>. The access token grants permission to get and create app users and conversations associated with the app. The token also grants permission to create webhooks, however only webhooks created for the integration will be visible. An access token with <code class="prettyprint">integration</code> scope cannot see or modify webhooks that were created by other integrations for example.</p>

<table><thead>
<tr>
<th><em>API Root</em></th>
<th><em>Access</em></th>
</tr>
</thead><tbody>
<tr>
<td><strong>/v1/appusers/</strong>*</td>
<td>Yes</td>
</tr>
<tr>
<td><strong>/v1/webhooks/</strong>*</td>
<td>Yes</td>
</tr>
<tr>
<td><strong>/v1/menu/</strong>*</td>
<td>No</td>
</tr>
</tbody></table>

      </div>
    </div>
  </body>
</html>
